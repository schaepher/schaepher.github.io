<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>æ‰‹åŠ¨éªŒè¯ TLS è¯ä¹¦ - Schaepher's Blog</title><meta name=Description content="æ·±é€ç†è§£ï¼Œç†Ÿç»ƒè¿ç”¨ï¼›ä¼¼æ‡‚éæ‡‚ï¼Œå…¶å®ä¸æ‡‚ã€‚"><meta property="og:title" content="æ‰‹åŠ¨éªŒè¯ TLS è¯ä¹¦"><meta property="og:description" content="è¯ä¹¦éªŒè¯ è¯ä¹¦ç»“æ„ æˆ‘ä»¬ç°åœ¨ä½¿ç”¨çš„ TLS è¯ä¹¦çš„æ ‡å‡†æ˜¯ X.509ï¼Œç‰ˆæœ¬å·ä¸º V3ã€‚ç‰ˆæœ¬å·å¯ä»è¯ä¹¦çš„ Version å­—æ®µçœ‹åˆ°ã€‚ æ ¹æ® RFC 3280 å®šä¹‰çš„è¯ä¹¦ç»“æ„ï¼Œè¯ä¹¦ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ"><meta property="og:type" content="article"><meta property="og:url" content="https://schaepher.github.io/2022/05/10/cert-verify/"><meta property="og:image" content="https://schaepher.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-10T12:30:00+00:00"><meta property="article:modified_time" content="2022-05-10T12:30:00+00:00"><meta property="og:site_name" content="Schaepher's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://schaepher.github.io/logo.png"><meta name=twitter:title content="æ‰‹åŠ¨éªŒè¯ TLS è¯ä¹¦"><meta name=twitter:description content="è¯ä¹¦éªŒè¯ è¯ä¹¦ç»“æ„ æˆ‘ä»¬ç°åœ¨ä½¿ç”¨çš„ TLS è¯ä¹¦çš„æ ‡å‡†æ˜¯ X.509ï¼Œç‰ˆæœ¬å·ä¸º V3ã€‚ç‰ˆæœ¬å·å¯ä»è¯ä¹¦çš„ Version å­—æ®µçœ‹åˆ°ã€‚ æ ¹æ® RFC 3280 å®šä¹‰çš„è¯ä¹¦ç»“æ„ï¼Œè¯ä¹¦ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ"><meta name=application-name content="Schaepher's Blog"><meta name=apple-mobile-web-app-title content="Schaepher's Blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://schaepher.github.io/2022/05/10/cert-verify/><link rel=prev href=https://schaepher.github.io/2022/05/08/2022-life-part1/><link rel=next href=https://schaepher.github.io/2022/05/11/tree-rotation/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"æ‰‹åŠ¨éªŒè¯ TLS è¯ä¹¦","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/schaepher.github.io\/2022\/05\/10\/cert-verify\/"},"genre":"posts","keywords":"HTTPS, TLS","wordcount":3404,"url":"https:\/\/schaepher.github.io\/2022\/05\/10\/cert-verify\/","datePublished":"2022-05-10T12:30:00+00:00","dateModified":"2022-05-10T12:30:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Schaepher"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Schaepher's Blog"></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/>ä¸»é¡µ </a><a class=menu-item href=/posts/ title=æ–‡ç« æŒ‰å¹´ä»½åˆ†ç±»>æ–‡ç«  </a><a class=menu-item href=/tags/>æ ‡ç­¾ </a><a class=menu-item href=/categories/>åˆ†ç±» </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=æœç´¢><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=æ¸…ç©º><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title=åˆ‡æ¢ä¸»é¢˜><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Schaepher's Blog"></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=æœç´¢><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=æ¸…ç©º><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>å–æ¶ˆ</a></div><a class=menu-item href=/ title>ä¸»é¡µ</a><a class=menu-item href=/posts/ title=æ–‡ç« æŒ‰å¹´ä»½åˆ†ç±»>æ–‡ç« </a><a class=menu-item href=/tags/ title>æ ‡ç­¾</a><a class=menu-item href=/categories/ title>åˆ†ç±»</a><a href=javascript:void(0); class="menu-item theme-switch" title=åˆ‡æ¢ä¸»é¢˜>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>ç›®å½•</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">æ‰‹åŠ¨éªŒè¯ TLS è¯ä¹¦</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://cnblogs.com/schaepher title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Schaepher</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-05-10>2022-05-10</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;çº¦ 3404 å­—&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;é¢„è®¡é˜…è¯» 7 åˆ†é’Ÿ&nbsp;</div></div><div class="details toc" id=toc-static data-kept=true><div class="details-summary toc-title"><span>ç›®å½•</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#è¯ä¹¦éªŒè¯>è¯ä¹¦éªŒè¯</a><ul><li><a href=#è¯ä¹¦ç»“æ„>è¯ä¹¦ç»“æ„</a></li><li><a href=#è¯ä¹¦éªŒè¯-1>è¯ä¹¦éªŒè¯</a><ul><li><a href=#è¯ä¹¦ä¸‹è½½>è¯ä¹¦ä¸‹è½½</a></li><li><a href=#der-è¯ä¹¦è§£æ>DER è¯ä¹¦è§£æ</a></li><li><a href=#è·å–è¯ä¹¦ä¸»ä½“å¾…ç­¾åè¯ä¹¦>è·å–è¯ä¹¦ä¸»ä½“ï¼ˆå¾…ç­¾åè¯ä¹¦ï¼‰</a></li><li><a href=#è®¡ç®—è¯ä¹¦-hash-å€¼>è®¡ç®—è¯ä¹¦ hash å€¼</a></li><li><a href=#ç­¾åå€¼>ç­¾åå€¼</a></li><li><a href=#ca-è¯ä¹¦å…¬é’¥>CA è¯ä¹¦å…¬é’¥</a></li><li><a href=#ä½¿ç”¨-ca-å…¬é’¥è§£å¯†>ä½¿ç”¨ CA å…¬é’¥è§£å¯†</a></li></ul></li><li><a href=#è¯ä¹¦é“¾>è¯ä¹¦é“¾</a></li></ul></li><li><a href=#å‚è€ƒ>å‚è€ƒ</a></li></ul></nav></div></div><div class=content id=content><h2 id=è¯ä¹¦éªŒè¯>è¯ä¹¦éªŒè¯</h2><h3 id=è¯ä¹¦ç»“æ„>è¯ä¹¦ç»“æ„</h3><p>æˆ‘ä»¬ç°åœ¨ä½¿ç”¨çš„ TLS è¯ä¹¦çš„æ ‡å‡†æ˜¯ X.509ï¼Œç‰ˆæœ¬å·ä¸º V3ã€‚ç‰ˆæœ¬å·å¯ä»è¯ä¹¦çš„ Version å­—æ®µçœ‹åˆ°ã€‚</p><p>æ ¹æ® <a href="https://datatracker.ietf.org/doc/html/rfc3280.html?msclkid=a0a5d923cf8211ec99debd4d1b18e2b5#section-4.1" target=_blank rel="noopener noreffer">RFC 3280</a> å®šä¹‰çš„è¯ä¹¦ç»“æ„ï¼Œè¯ä¹¦ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p><ol><li>è¯ä¹¦ä¸»ä½“ï¼ˆTBSCertificateï¼ŒTo Be Signed Certificateï¼Œå¾…ç­¾åè¯ä¹¦ï¼‰</li><li>ç­¾åç®—æ³•</li><li>ç­¾åå€¼</li></ol><p>è¯ä¹¦ä¸»ä½“åŒ…æ‹¬ç‰ˆæœ¬ã€åºåˆ—å·ã€å…¬é’¥ç­‰å†…å®¹ã€‚ç­¾åå€¼æ˜¯å¯¹è¯ä¹¦ä¸»ä½“ä½¿ç”¨ç­¾åç®—æ³•è®¡ç®—å¹¶ç»è¿‡è¯ä¹¦ç­¾åæœºæ„ç§é’¥åŠ å¯†åçš„å€¼ã€‚</p><p>è¯ä¹¦çš„æ•°æ®ç»„ç»‡æ ¼å¼ä¸º ASN.1 DER æ ¼å¼ï¼ˆdistinguished encoding rulesï¼‰ã€‚è¿™æ˜¯ä¸€ç§ TLV ç¼–ç ï¼Œå…¶ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½åŒ…å« Tagã€Lengthã€Valueã€‚é€šå¸¸æˆ‘ä»¬è·å¾—çš„è¯ä¹¦æ˜¯ç»ç”± Base64 ç¼–ç åçš„ PEM æ–‡ä»¶ï¼Œä¸ºäº†èŠ‚çœä¸å¿…è¦çš„éº»çƒ¦ï¼Œåç»­å†…å®¹ä¼šæå‰å°†è¯ä¹¦è½¬å› DER æ ¼å¼ã€‚</p><p>PEM æ–‡ä»¶çš„æ ¼å¼æ˜¯è¿™æ ·çš„ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>-----BEGIN CERTIFICATE-----
</span></span><span class=line><span class=cl>è¿™é‡Œæ˜¯ Base64 ç¼–ç åçš„å†…å®¹
</span></span><span class=line><span class=cl>-----END CERTIFICATE-----
</span></span></code></pre></td></tr></table></div></div><h3 id=è¯ä¹¦éªŒè¯-1>è¯ä¹¦éªŒè¯</h3><p>ä¸ºäº†éªŒè¯è¯ä¹¦ï¼Œæˆ‘ä»¬éœ€è¦è·å–ä»¥ä¸‹å†…å®¹ï¼š</p><ol><li>è¯ä¹¦ä¸»ä½“ã€‚ç”¨äºé€šè¿‡ç­¾åç®—æ³•å¾—åˆ°å…¶ hash å€¼</li><li>è¯ä¹¦ç­¾åå€¼ã€‚</li><li>CA çš„å…¬é’¥ã€‚ç”¨äºè§£å¯†ç­¾åï¼Œå¾—åˆ°è¯ä¹¦ä¸»ä½“çš„ hash å€¼</li></ol><p>å¦‚æœ 1 å’Œ 3 çš„ hash å€¼ç›¸ç­‰ï¼Œåˆ™è¯´æ˜æ­¤æ¬¡éªŒè¯é€šè¿‡ã€‚</p><p>æˆ‘ä»¬ä»¥åšå®¢å›­çš„è¯ä¹¦ä¸ºä¾‹ã€‚</p><h4 id=è¯ä¹¦ä¸‹è½½>è¯ä¹¦ä¸‹è½½</h4><ol><li>ä¸‹è½½åšå®¢å›­è¯ä¹¦<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> -n <span class=p>|</span> openssl s_client -connect www.cnblogs.com:443 <span class=p>|</span> openssl x509 -outform DER &gt; www.cnblogs.com.crt
</span></span></code></pre></td></tr></table></div></div>è¯ä¹¦åŸæ–‡æ˜¯ç”¨ Base64 ç¼–ç åçš„ PEM æ ¼å¼æ–‡ä»¶ï¼Œè¿™é‡Œå°†å…¶ç›´æ¥è½¬æ¢ä¸º DER æ ¼å¼ã€‚</li><li>æŸ¥çœ‹åšå®¢å›­çš„ CA è¯ä¹¦åœ°å€<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl x509 -inform DER -in www.cnblogs.com.crt -noout -text  <span class=p>|</span> grep <span class=s2>&#34;CA Issuers&#34;</span>
</span></span></code></pre></td></tr></table></div></div>å¾—åˆ°ï¼š<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>CA Issuers - URI:http://cacerts.digicert.com/EncryptionEverywhereDVTLSCA-G1.crt
</span></span></code></pre></td></tr></table></div></div></li><li>ä¸‹è½½ CA è¯ä¹¦<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -O http://cacerts.digicert.com/EncryptionEverywhereDVTLSCA-G1.crt
</span></span></code></pre></td></tr></table></div></div>è¿™ä¸ªè¯ä¹¦å·²ç»æ˜¯ DER æ ¼å¼ï¼Œæ— éœ€è½¬æ¢ã€‚</li></ol><p>ç°åœ¨ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ï¼š</p><ul><li>åšå®¢å›­è¯ä¹¦</li><li>ç»™åšå®¢å›­è¯ä¹¦ç­¾åçš„ CA çš„è¯ä¹¦</li></ul><h4 id=der-è¯ä¹¦è§£æ>DER è¯ä¹¦è§£æ</h4><p>åœ¨å¼€å§‹éªŒè¯ä¹‹å‰ï¼Œå†æ¬¡äº†è§£è¯ä¹¦çš„æ ¼å¼ï¼Œä¾¿äºç†è§£åç»­çš„è·å–æ“ä½œã€‚</p><p>è¯ä¹¦ç”±è¯ä¹¦ä¸»ä½“ã€ç­¾åç®—æ³•å’Œç­¾åå€¼ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆã€‚DER æ ¼å¼æ¯ä¸ªå…ƒç´ ä»¥ SEQUENCE ä½œä¸ºå¼€å¤´ã€‚ç”±äºå®Œæ•´çš„è¯ä¹¦æ˜¯ä¸€ä¸ª SEQUENCEï¼Œå› æ­¤è¯ä¹¦æœ€å¤–å±‚æœ‰ä¸ª SEQUENCEã€‚é‡Œé¢ä¸‰ä¸ªéƒ¨åˆ†éƒ½å„è‡ªæœ‰ä¸€ä¸ª SEQUENCEã€‚</p><p>æ‰§è¡Œå‘½ä»¤æŸ¥çœ‹å†…å®¹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl asn1parse -i -inform DER -in www.cnblogs.com.crt
</span></span></code></pre></td></tr></table></div></div><p>è§£æçš„æ ¼å¼ä¸ºï¼šå¼€å¤´æ•°å­—æ˜¯åç§»é‡ï¼Œd è¡¨ç¤ºæ·±åº¦ï¼ˆdepthï¼‰ï¼Œd ç›¸åŒçš„è¡¨ç¤ºæ˜¯åŒä¸€ä¸ªå±‚çº§ã€‚hl è¡¨ç¤ºå¤´éƒ¨é•¿åº¦ï¼ˆheader lengthï¼‰ï¼Œl è¡¨ç¤ºä¸åŒ…å«å¤´éƒ¨çš„æ•°æ®é•¿åº¦ï¼ˆlenghtï¼‰ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>    0:d=0  hl=4 l=1534 cons: SEQUENCE
</span></span><span class=line><span class=cl>    4:d=1  hl=4 l=1254 cons:  SEQUENCE
</span></span><span class=line><span class=cl>    8:d=2  hl=2 l=   3 cons:   cont [ 0 ]
</span></span><span class=line><span class=cl>   10:d=3  hl=2 l=   1 prim:    INTEGER           :02
</span></span><span class=line><span class=cl>   13:d=2  hl=2 l=  16 prim:   INTEGER           :03E3AC5347CD4A3862C2855A71A6F94F
</span></span><span class=line><span class=cl>   31:d=2  hl=2 l=  13 cons:   SEQUENCE
</span></span><span class=line><span class=cl>   33:d=3  hl=2 l=   9 prim:    OBJECT            :sha256WithRSAEncryption
</span></span><span class=line><span class=cl>   44:d=3  hl=2 l=   0 prim:    NULL
</span></span><span class=line><span class=cl>   46:d=2  hl=2 l= 110 cons:   SEQUENCE
</span></span><span class=line><span class=cl>   48:d=3  hl=2 l=  11 cons:    SET
</span></span><span class=line><span class=cl>   50:d=4  hl=2 l=   9 cons:     SEQUENCE
</span></span><span class=line><span class=cl>   52:d=5  hl=2 l=   3 prim:      OBJECT            :countryName
</span></span><span class=line><span class=cl>   57:d=5  hl=2 l=   2 prim:      PRINTABLESTRING   :US
</span></span><span class=line><span class=cl>   61:d=3  hl=2 l=  21 cons:    SET
</span></span><span class=line><span class=cl>   63:d=4  hl=2 l=  19 cons:     SEQUENCE
</span></span><span class=line><span class=cl>   65:d=5  hl=2 l=   3 prim:      OBJECT            :organizationName
</span></span><span class=line><span class=cl>   70:d=5  hl=2 l=  12 prim:      PRINTABLESTRING   :DigiCert Inc
</span></span><span class=line><span class=cl>   84:d=3  hl=2 l=  25 cons:    SET
</span></span><span class=line><span class=cl>   86:d=4  hl=2 l=  23 cons:     SEQUENCE
</span></span><span class=line><span class=cl>   88:d=5  hl=2 l=   3 prim:      OBJECT            :organizationalUnitName
</span></span><span class=line><span class=cl>   93:d=5  hl=2 l=  16 prim:      PRINTABLESTRING   :www.digicert.com
</span></span><span class=line><span class=cl>  111:d=3  hl=2 l=  45 cons:    SET
</span></span><span class=line><span class=cl>  113:d=4  hl=2 l=  43 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  115:d=5  hl=2 l=   3 prim:      OBJECT            :commonName
</span></span><span class=line><span class=cl>  120:d=5  hl=2 l=  36 prim:      PRINTABLESTRING   :Encryption Everywhere DV TLS CA - G1
</span></span><span class=line><span class=cl>  158:d=2  hl=2 l=  30 cons:   SEQUENCE
</span></span><span class=line><span class=cl>  160:d=3  hl=2 l=  13 prim:    UTCTIME           :220228000000Z
</span></span><span class=line><span class=cl>  175:d=3  hl=2 l=  13 prim:    UTCTIME           :230301235959Z
</span></span><span class=line><span class=cl>  190:d=2  hl=2 l=  24 cons:   SEQUENCE
</span></span><span class=line><span class=cl>  192:d=3  hl=2 l=  22 cons:    SET
</span></span><span class=line><span class=cl>  194:d=4  hl=2 l=  20 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  196:d=5  hl=2 l=   3 prim:      OBJECT            :commonName
</span></span><span class=line><span class=cl>  201:d=5  hl=2 l=  13 prim:      UTF8STRING        :*.cnblogs.com
</span></span><span class=line><span class=cl>  216:d=2  hl=4 l= 290 cons:   SEQUENCE
</span></span><span class=line><span class=cl>  220:d=3  hl=2 l=  13 cons:    SEQUENCE
</span></span><span class=line><span class=cl>  222:d=4  hl=2 l=   9 prim:     OBJECT            :rsaEncryption
</span></span><span class=line><span class=cl>  233:d=4  hl=2 l=   0 prim:     NULL
</span></span><span class=line><span class=cl>  235:d=3  hl=4 l= 271 prim:    BIT STRING
</span></span><span class=line><span class=cl>  510:d=2  hl=4 l= 748 cons:   cont [ 3 ]
</span></span><span class=line><span class=cl>  514:d=3  hl=4 l= 744 cons:    SEQUENCE
</span></span><span class=line><span class=cl>  518:d=4  hl=2 l=  31 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  520:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Authority Key Identifier
</span></span><span class=line><span class=cl>  525:d=5  hl=2 l=  24 prim:      OCTET STRING      [HEX DUMP]:3016801455744FB2724FF560BA50D1D7E6515C9A01871AD7
</span></span><span class=line><span class=cl>  551:d=4  hl=2 l=  29 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  553:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Subject Key Identifier
</span></span><span class=line><span class=cl>  558:d=5  hl=2 l=  22 prim:      OCTET STRING      [HEX DUMP]:04149DE559358AA4C25E1A52193A745F007F101B1C17
</span></span><span class=line><span class=cl>  582:d=4  hl=2 l=  37 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  584:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Subject Alternative Name
</span></span><span class=line><span class=cl>  589:d=5  hl=2 l=  30 prim:      OCTET STRING      [HEX DUMP]:301C820D2A2E636E626C6F67732E636F6D820B636E626C6F67732E636F6D
</span></span><span class=line><span class=cl>  621:d=4  hl=2 l=  14 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  623:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Key Usage
</span></span><span class=line><span class=cl>  628:d=5  hl=2 l=   1 prim:      BOOLEAN           :255
</span></span><span class=line><span class=cl>  631:d=5  hl=2 l=   4 prim:      OCTET STRING      [HEX DUMP]:030205A0
</span></span><span class=line><span class=cl>  637:d=4  hl=2 l=  29 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  639:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Extended Key Usage
</span></span><span class=line><span class=cl>  644:d=5  hl=2 l=  22 prim:      OCTET STRING      [HEX DUMP]:301406082B0601050507030106082B06010505070302
</span></span><span class=line><span class=cl>  668:d=4  hl=2 l=  62 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  670:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Certificate Policies
</span></span><span class=line><span class=cl>  675:d=5  hl=2 l=  55 prim:      OCTET STRING      [HEX DUMP]:30353033060667810C0102013029302706082B06010505070201161B687474703A2F2F7777772E64696769636572742E636F6D2F435053
</span></span><span class=line><span class=cl>  732:d=4  hl=3 l= 128 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  735:d=5  hl=2 l=   8 prim:      OBJECT            :Authority Information Access
</span></span><span class=line><span class=cl>  745:d=5  hl=2 l= 116 prim:      OCTET STRING      [HEX DUMP]:3072302406082B060105050730018618687474703A2F2F6F6373702E64696769636572742E636F6D304A06082B06010505073002863E687474703A2F2F636163657274732E64696769636572742E636F6D2F456E6372797074696F6E457665727977686572654456544C5343412D47312E637274
</span></span><span class=line><span class=cl>  863:d=4  hl=2 l=   9 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  865:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Basic Constraints
</span></span><span class=line><span class=cl>  870:d=5  hl=2 l=   2 prim:      OCTET STRING      [HEX DUMP]:3000
</span></span><span class=line><span class=cl>  874:d=4  hl=4 l= 384 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  878:d=5  hl=2 l=  10 prim:      OBJECT            :CT Precertificate SCTs
</span></span><span class=line><span class=cl>  890:d=5  hl=4 l= 368 prim:      OCTET STRING      [HEX DUMP]:0482016C016A007700E83ED0DA3EF5063532E75728BC896BC903D3CBD1116BECEB69E1777D6D06BD6E0000017F3E1A44D10000040300483046022100D8162F949F2820F1C3CCF73AD2826F04CDD3EA09C16BAD2441AE07C69D149DE1022100AC4C3B8EB60C5613C32B85C5303ACC67F62888DFB7925861088B21B550E16E9600760035CF191BBFB16C57BF0FAD4C6D42CBBBB627202651EA3FE12AEFA803C33BD64C0000017F3E1A45110000040300473045022100A4D6915799132F3997B16F009F7011520A3BB30A040DAE42B73D905975DBADBD02206165D6DA0CB72F87B8FA7F309806919893FA962126F6D94512DB700CDF019B84007700B3737707E18450F86386D605A9DC11094A792DB1670C0B87DCF0030E7936A59A0000017F3E1A45370000040300483046022100B31A83931E8A4D8BD4FD2F28E8C42D3B1083D79E9F5E7F9F8B8D1C4D33DE8C65022100E6D91B7986CA850272265DEDBD4C40180BB73B69447304F423BDA19B29F4ADE3
</span></span><span class=line><span class=cl> 1262:d=1  hl=2 l=  13 cons:  SEQUENCE
</span></span><span class=line><span class=cl> 1264:d=2  hl=2 l=   9 prim:   OBJECT            :sha256WithRSAEncryption
</span></span><span class=line><span class=cl> 1275:d=2  hl=2 l=   0 prim:   NULL
</span></span><span class=line><span class=cl> 1277:d=1  hl=4 l= 257 prim:  BIT STRING
</span></span></code></pre></td></tr></table></div></div><p>ä¾‹å¦‚ç¬¬ä¸€è¡Œï¼š<br><code>0:d=0 hl=4 l=1534 cons: SEQUENCE</code></p><p>å¼€å¤´ 0 è¡¨ç¤ºåç§»é‡ä¸º 0ï¼Œå°±æ˜¯æ•´ä¸ªæ–‡ä»¶çš„å¼€å¤´ã€‚d=0 è¡¨ç¤ºæœ€é¡¶å±‚ï¼Œä¸ºæ•´ä¸ªè¯ä¹¦çš„å¯¹è±¡ã€‚å¤´éƒ¨é•¿åº¦ä¸º 4 å­—èŠ‚ï¼Œæ•°æ®å­—æ®µï¼ˆä¹Ÿå°±æ˜¯ä¸‰ä¸ªéƒ¨åˆ†ï¼‰æ€»å…± 1534 å­—èŠ‚ï¼ŒåŠ èµ·æ¥æ•´ä¸ªæ–‡ä»¶å…± 1538 å­—èŠ‚ã€‚</p><p>å†çœ‹æœ€åä¸€è¡Œï¼Œ</p><p><code>1277:d=1 hl=4 l= 257 prim: BIT STRING</code></p><p>å¼€å¤´ 1277 è¡¨ç¤ºåç§»é‡ï¼Œd=1 è¡¨ç¤ºé¡¶å±‚çš„ä¸‹ä¸€å±‚ï¼Œè€Œè¿™ä¸ªä½ç½®åœ¨æœ€åä¸€éƒ¨åˆ†ï¼Œé‚£ä¹ˆå°±ä»£è¡¨æ˜¯ç­¾åå€¼ã€‚å¤´éƒ¨é•¿åº¦ä¸º 4 å­—èŠ‚ï¼Œæ•°æ®é•¿åº¦ä¸º 257 å­—èŠ‚ï¼ŒåŠ èµ·æ¥å…± 261 å­—èŠ‚ã€‚åŠ ä¸Šåç§»é‡ 1277 + 261 = 1538 å­—èŠ‚ï¼Œä¸ç¬¬ä¸€è¡Œçš„è®¡ç®—ç»“æœå»åˆã€‚</p><h4 id=è·å–è¯ä¹¦ä¸»ä½“å¾…ç­¾åè¯ä¹¦>è·å–è¯ä¹¦ä¸»ä½“ï¼ˆå¾…ç­¾åè¯ä¹¦ï¼‰</h4><p>æ ¹æ®å®šä¹‰ï¼Œç¬¬ä¸€ä¸ªéƒ¨åˆ†å°±æ˜¯å¾…ç­¾åè¯ä¹¦ã€‚å› æ­¤ä»ç¬¬ä¸€ä¸ª d=1 çš„åœ°æ–¹å¼€å§‹ï¼Œå³æ–‡ä»¶çš„ç¬¬äºŒè¡Œã€‚</p><p><code>4:d=1 hl=4 l=1254 cons: SEQUENCE</code></p><p>è¡¨ç¤ºåç§»é‡ä¸º 4ï¼Œå¤´éƒ¨ 4 å­—èŠ‚ï¼Œæ•°æ® 1254 å­—èŠ‚ã€‚hash çš„æ—¶å€™ä¼šè¿å¤´éƒ¨éƒ½ç®—ä¸Šï¼Œæ‰€ä»¥æ€»å…±è·å– 1258 å­—èŠ‚ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>dd <span class=k>if</span><span class=o>=</span>www.cnblogs.com.crt <span class=nv>of</span><span class=o>=</span>www.cnblogs.com.tbs <span class=nv>bs</span><span class=o>=</span><span class=m>1</span> <span class=nv>skip</span><span class=o>=</span><span class=m>4</span> <span class=nv>count</span><span class=o>=</span><span class=m>1258</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™é‡Œ bs=1 è¡¨ç¤ºæ¯æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼Œcount è¡¨ç¤ºè¯»å– 1258 æ¬¡ï¼Œä¸¤è€…ç»„åˆèµ·æ¥å°±æ˜¯è¯»å– 1258 ä¸ªå­—èŠ‚ã€‚</p><h4 id=è®¡ç®—è¯ä¹¦-hash-å€¼>è®¡ç®—è¯ä¹¦ hash å€¼</h4><p>è·å–ç­¾åå’ŒåŠ å¯†ç®—æ³•ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>openssl x509 -inform DER -in www.cnblogs.com.crt -noout -text | grep &#39;Signature Algorithm&#39; | tail -n 1
</span></span></code></pre></td></tr></table></div></div><p>sha256WithRSAEncryption è¡¨ç¤ºä½¿ç”¨ sha256 hashï¼Œå¹¶ä½¿ç”¨ RSA åŠ å¯†ã€‚</p><p>è®¡ç®—ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sha256sum www.cnblogs.com.tbs
</span></span></code></pre></td></tr></table></div></div><p>å¾—åˆ°ç»“æœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>bca9d80920262764ca037b51a1f7bfd8a240c8059c7564dafdaf12ded366d6f5  www.cnblogs.com.tbs
</span></span></code></pre></td></tr></table></div></div><h4 id=ç­¾åå€¼>ç­¾åå€¼</h4><p>ä» ASN.1 è§£æåçš„æ•°æ®ï¼Œå¯ä»¥çŸ¥é“ç­¾åå€¼çš„åç§»é‡æ˜¯ 1277ã€‚</p><p>æˆªå–ç­¾åå€¼ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl asn1parse  -inform DER -in www.cnblogs.com.crt --strparse <span class=m>1277</span> -noout -out www.cnblogs.com.sig
</span></span></code></pre></td></tr></table></div></div><p>éªŒè¯è¿™ä¸ªæ•°æ®ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>xxd -p www.cnblogs.com.sig  <span class=p>|</span> tr -d <span class=s1>&#39;\n&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>å¾—åˆ°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>49aa4a0ff0052f53f27fd1681b11f6247a75b6da247b589a8cec50a7abd3e1ddc9cbbd09a221e529466bdacb34d3bf9555fa4714731b33326cf341d2cd5ac6b5996d22a682dcd8a97ea2245b3318fddc423d17d16318cd925c6d5873a40f16d9b0a6393c18e66d57be6c30688d10faf55b833479cb2735835210c7c6869bc2c33edf7acb531e1e96d3a47796d0f2fe3c3784d3f35e0e7824094bb4b388e8d95861b864a71c50e3b6da9512be585a14196dc7ec2e80f74a06fead44b7340f1a6c3fa1451bd64eadf8ec71d866dee43e44cfcaae3ecc9804e12037400e6548ce77c080d2b09840aa7297aa862679f228a7fac1187a68355946d49a5ae7389d6a38
</span></span></code></pre></td></tr></table></div></div><p>æŸ¥çœ‹å¾—åˆ°çš„ç»“æœæ˜¯å¦ä¸ä»¥ä¸‹å‘½ä»¤çš„æœ€åä¸€éƒ¨åˆ†ä¸€è‡´ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl x509 -inform DER -in www.cnblogs.com.crt -noout -text
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>49:aa:4a:0f:f0:05:2f:53:f2:7f:d1:68:1b:11:f6:24:7a:75:
</span></span><span class=line><span class=cl>b6:da:24:7b:58:9a:8c:ec:50:a7:ab:d3:e1:dd:c9:cb:bd:09:
</span></span><span class=line><span class=cl>a2:21:e5:29:46:6b:da:cb:34:d3:bf:95:55:fa:47:14:73:1b:
</span></span><span class=line><span class=cl>33:32:6c:f3:41:d2:cd:5a:c6:b5:99:6d:22:a6:82:dc:d8:a9:
</span></span><span class=line><span class=cl>7e:a2:24:5b:33:18:fd:dc:42:3d:17:d1:63:18:cd:92:5c:6d:
</span></span><span class=line><span class=cl>58:73:a4:0f:16:d9:b0:a6:39:3c:18:e6:6d:57:be:6c:30:68:
</span></span><span class=line><span class=cl>8d:10:fa:f5:5b:83:34:79:cb:27:35:83:52:10:c7:c6:86:9b:
</span></span><span class=line><span class=cl>c2:c3:3e:df:7a:cb:53:1e:1e:96:d3:a4:77:96:d0:f2:fe:3c:
</span></span><span class=line><span class=cl>37:84:d3:f3:5e:0e:78:24:09:4b:b4:b3:88:e8:d9:58:61:b8:
</span></span><span class=line><span class=cl>64:a7:1c:50:e3:b6:da:95:12:be:58:5a:14:19:6d:c7:ec:2e:
</span></span><span class=line><span class=cl>80:f7:4a:06:fe:ad:44:b7:34:0f:1a:6c:3f:a1:45:1b:d6:4e:
</span></span><span class=line><span class=cl>ad:f8:ec:71:d8:66:de:e4:3e:44:cf:ca:ae:3e:cc:98:04:e1:
</span></span><span class=line><span class=cl>20:37:40:0e:65:48:ce:77:c0:80:d2:b0:98:40:aa:72:97:aa:
</span></span><span class=line><span class=cl>86:26:79:f2:28:a7:fa:c1:18:7a:68:35:59:46:d4:9a:5a:e7:
</span></span><span class=line><span class=cl>38:9d:6a:38
</span></span></code></pre></td></tr></table></div></div><p>è¿™éƒ¨åˆ†ç›´æ¥ä»å®Œæ•´çš„ text ä¸­å¤åˆ¶ç„¶åæ‰‹åŠ¨ç¼–è¾‘ä¹Ÿå¯ä»¥ã€‚</p><h4 id=ca-è¯ä¹¦å…¬é’¥>CA è¯ä¹¦å…¬é’¥</h4><p>è§£æå¹¶æŸ¥çœ‹ä½ç½®ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl asn1parse -i -inform DER -in EncryptionEverywhereDVTLSCA-G1.crt
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>    0:d=0  hl=4 l=1194 cons: SEQUENCE
</span></span><span class=line><span class=cl>    4:d=1  hl=4 l= 914 cons:  SEQUENCE
</span></span><span class=line><span class=cl>    8:d=2  hl=2 l=   3 cons:   cont [ 0 ]
</span></span><span class=line><span class=cl>   10:d=3  hl=2 l=   1 prim:    INTEGER           :02
</span></span><span class=line><span class=cl>   13:d=2  hl=2 l=  16 prim:   INTEGER           :0279AC458BC1B245ABF98053CD2C9BB1
</span></span><span class=line><span class=cl>   31:d=2  hl=2 l=  13 cons:   SEQUENCE
</span></span><span class=line><span class=cl>   33:d=3  hl=2 l=   9 prim:    OBJECT            :sha256WithRSAEncryption
</span></span><span class=line><span class=cl>   44:d=3  hl=2 l=   0 prim:    NULL
</span></span><span class=line><span class=cl>   46:d=2  hl=2 l=  97 cons:   SEQUENCE
</span></span><span class=line><span class=cl>   48:d=3  hl=2 l=  11 cons:    SET
</span></span><span class=line><span class=cl>   50:d=4  hl=2 l=   9 cons:     SEQUENCE
</span></span><span class=line><span class=cl>   52:d=5  hl=2 l=   3 prim:      OBJECT            :countryName
</span></span><span class=line><span class=cl>   57:d=5  hl=2 l=   2 prim:      PRINTABLESTRING   :US
</span></span><span class=line><span class=cl>   61:d=3  hl=2 l=  21 cons:    SET
</span></span><span class=line><span class=cl>   63:d=4  hl=2 l=  19 cons:     SEQUENCE
</span></span><span class=line><span class=cl>   65:d=5  hl=2 l=   3 prim:      OBJECT            :organizationName
</span></span><span class=line><span class=cl>   70:d=5  hl=2 l=  12 prim:      PRINTABLESTRING   :DigiCert Inc
</span></span><span class=line><span class=cl>   84:d=3  hl=2 l=  25 cons:    SET
</span></span><span class=line><span class=cl>   86:d=4  hl=2 l=  23 cons:     SEQUENCE
</span></span><span class=line><span class=cl>   88:d=5  hl=2 l=   3 prim:      OBJECT            :organizationalUnitName
</span></span><span class=line><span class=cl>   93:d=5  hl=2 l=  16 prim:      PRINTABLESTRING   :www.digicert.com
</span></span><span class=line><span class=cl>  111:d=3  hl=2 l=  32 cons:    SET
</span></span><span class=line><span class=cl>  113:d=4  hl=2 l=  30 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  115:d=5  hl=2 l=   3 prim:      OBJECT            :commonName
</span></span><span class=line><span class=cl>  120:d=5  hl=2 l=  23 prim:      PRINTABLESTRING   :DigiCert Global Root CA
</span></span><span class=line><span class=cl>  145:d=2  hl=2 l=  30 cons:   SEQUENCE
</span></span><span class=line><span class=cl>  147:d=3  hl=2 l=  13 prim:    UTCTIME           :171127124610Z
</span></span><span class=line><span class=cl>  162:d=3  hl=2 l=  13 prim:    UTCTIME           :271127124610Z
</span></span><span class=line><span class=cl>  177:d=2  hl=2 l= 110 cons:   SEQUENCE
</span></span><span class=line><span class=cl>  179:d=3  hl=2 l=  11 cons:    SET
</span></span><span class=line><span class=cl>  181:d=4  hl=2 l=   9 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  183:d=5  hl=2 l=   3 prim:      OBJECT            :countryName
</span></span><span class=line><span class=cl>  188:d=5  hl=2 l=   2 prim:      PRINTABLESTRING   :US
</span></span><span class=line><span class=cl>  192:d=3  hl=2 l=  21 cons:    SET
</span></span><span class=line><span class=cl>  194:d=4  hl=2 l=  19 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  196:d=5  hl=2 l=   3 prim:      OBJECT            :organizationName
</span></span><span class=line><span class=cl>  201:d=5  hl=2 l=  12 prim:      PRINTABLESTRING   :DigiCert Inc
</span></span><span class=line><span class=cl>  215:d=3  hl=2 l=  25 cons:    SET
</span></span><span class=line><span class=cl>  217:d=4  hl=2 l=  23 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  219:d=5  hl=2 l=   3 prim:      OBJECT            :organizationalUnitName
</span></span><span class=line><span class=cl>  224:d=5  hl=2 l=  16 prim:      PRINTABLESTRING   :www.digicert.com
</span></span><span class=line><span class=cl>  242:d=3  hl=2 l=  45 cons:    SET
</span></span><span class=line><span class=cl>  244:d=4  hl=2 l=  43 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  246:d=5  hl=2 l=   3 prim:      OBJECT            :commonName
</span></span><span class=line><span class=cl>  251:d=5  hl=2 l=  36 prim:      PRINTABLESTRING   :Encryption Everywhere DV TLS CA - G1
</span></span><span class=line><span class=cl>  289:d=2  hl=4 l= 290 cons:   SEQUENCE
</span></span><span class=line><span class=cl>  293:d=3  hl=2 l=  13 cons:    SEQUENCE
</span></span><span class=line><span class=cl>  295:d=4  hl=2 l=   9 prim:     OBJECT            :rsaEncryption
</span></span><span class=line><span class=cl>  306:d=4  hl=2 l=   0 prim:     NULL
</span></span><span class=line><span class=cl>  308:d=3  hl=4 l= 271 prim:    BIT STRING
</span></span><span class=line><span class=cl>  583:d=2  hl=4 l= 335 cons:   cont [ 3 ]
</span></span><span class=line><span class=cl>  587:d=3  hl=4 l= 331 cons:    SEQUENCE
</span></span><span class=line><span class=cl>  591:d=4  hl=2 l=  29 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  593:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Subject Key Identifier
</span></span><span class=line><span class=cl>  598:d=5  hl=2 l=  22 prim:      OCTET STRING      [HEX DUMP]:041455744FB2724FF560BA50D1D7E6515C9A01871AD7
</span></span><span class=line><span class=cl>  622:d=4  hl=2 l=  31 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  624:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Authority Key Identifier
</span></span><span class=line><span class=cl>  629:d=5  hl=2 l=  24 prim:      OCTET STRING      [HEX DUMP]:3016801403DE503556D14CBB66F0A3E21B1BC397B23DD155
</span></span><span class=line><span class=cl>  655:d=4  hl=2 l=  14 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  657:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Key Usage
</span></span><span class=line><span class=cl>  662:d=5  hl=2 l=   1 prim:      BOOLEAN           :255
</span></span><span class=line><span class=cl>  665:d=5  hl=2 l=   4 prim:      OCTET STRING      [HEX DUMP]:03020186
</span></span><span class=line><span class=cl>  671:d=4  hl=2 l=  29 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  673:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Extended Key Usage
</span></span><span class=line><span class=cl>  678:d=5  hl=2 l=  22 prim:      OCTET STRING      [HEX DUMP]:301406082B0601050507030106082B06010505070302
</span></span><span class=line><span class=cl>  702:d=4  hl=2 l=  18 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  704:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Basic Constraints
</span></span><span class=line><span class=cl>  709:d=5  hl=2 l=   1 prim:      BOOLEAN           :255
</span></span><span class=line><span class=cl>  712:d=5  hl=2 l=   8 prim:      OCTET STRING      [HEX DUMP]:30060101FF020100
</span></span><span class=line><span class=cl>  722:d=4  hl=2 l=  52 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  724:d=5  hl=2 l=   8 prim:      OBJECT            :Authority Information Access
</span></span><span class=line><span class=cl>  734:d=5  hl=2 l=  40 prim:      OCTET STRING      [HEX DUMP]:3026302406082B060105050730018618687474703A2F2F6F6373702E64696769636572742E636F6D
</span></span><span class=line><span class=cl>  776:d=4  hl=2 l=  66 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  778:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 CRL Distribution Points
</span></span><span class=line><span class=cl>  783:d=5  hl=2 l=  59 prim:      OCTET STRING      [HEX DUMP]:30393037A035A0338631687474703A2F2F63726C332E64696769636572742E636F6D2F4469676943657274476C6F62616C526F6F7443412E63726C
</span></span><span class=line><span class=cl>  844:d=4  hl=2 l=  76 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  846:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Certificate Policies
</span></span><span class=line><span class=cl>  851:d=5  hl=2 l=  69 prim:      OCTET STRING      [HEX DUMP]:3043303706096086480186FD6C0102302A302806082B06010505070201161C68747470733A2F2F7777772E64696769636572742E636F6D2F4350533008060667810C010201
</span></span><span class=line><span class=cl>  922:d=1  hl=2 l=  13 cons:  SEQUENCE
</span></span><span class=line><span class=cl>  924:d=2  hl=2 l=   9 prim:   OBJECT            :sha256WithRSAEncryption
</span></span><span class=line><span class=cl>  935:d=2  hl=2 l=   0 prim:   NULL
</span></span><span class=line><span class=cl>  937:d=1  hl=4 l= 257 prim:  BIT STRING
</span></span></code></pre></td></tr></table></div></div><p>æ‰¾åˆ° <code>rsaEncryption</code>ï¼Œå®ƒåœ¨ d=4 çš„å±‚çº§ï¼Œå…¬é’¥æ‰€åœ¨ä½ç½®ä¸ºä¸‹æ–¹çš„ d=3 å±‚çº§çš„ BIT STRINGï¼š</p><p><code>308:d=3 hl=4 l= 271</code></p><p>æ ¹æ® <a href=https://datatracker.ietf.org/doc/html/rfc3279#section-2.3.1 target=_blank rel="noopener noreffer">rfc 3279</a> çš„å®šä¹‰ï¼ŒRSA PublickKey ç”±ç³»æ•° (modulus) å’ŒæŒ‡æ•° (exponent) ä¸¤éƒ¨åˆ†ç»„æˆã€‚å› æ­¤ 271 å­—èŠ‚é‡Œé¢çš„ä¸¤éƒ¨åˆ†è¦åˆ†å¼€è·å–ã€‚è¿™ä¸¤éƒ¨åˆ†ä¹Ÿæ˜¯ä½¿ç”¨ DER æ ¼å¼ç¼–ç çš„ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å·¥å…·è§£æï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>openssl asn1parse -inform DER -in EncryptionEverywhereDVTLSCA-G1.crt --strparse 308 -noout -out EncryptionEverywhereDVTLSCA-G1.rsa
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>openssl asn1parse -i -inform DER -in EncryptionEverywhereDVTLSCA-G1.rsa
</span></span></code></pre></td></tr></table></div></div><p>å¾—åˆ°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>    0:d=0  hl=4 l= 266 cons: SEQUENCE
</span></span><span class=line><span class=cl>    4:d=1  hl=4 l= 257 prim:  INTEGER           :B3DE3FAC2469BE35772421EA629CA07AADDE3448C56E4C0EF7FD43288E47B55F1702BAE7A7ACD1416221BEF837DA519EDCC5D54818CC31AEDE9A5954C76895BC619BA7564BD38AFE515E84A353D0E608F5AAA4E85F94EDC03A8F1482FA20C13D7C1D178AECDCA472A776909FAA63A69D72AFB201E98E33BFBD847BF3E567FEAB2BA2270BA5A92B49CF54E611EE7F620EE3DED44E08C543011FF4F7DFEDE1CAE1F776F7E089650E5248DDA4C6F2C57F973657B9B84222C81B22E08BDB7130A1F2BBA27C2222E660D7919AE7313F27C1F60257ABFA90375791B80644B2AC478A6E71B26D6CAA889141B1B99236B7BA5F7B02917399D679CBC30597F7FA9D4CA40F
</span></span><span class=line><span class=cl>  265:d=1  hl=2 l=   3 prim:  INTEGER           :010001
</span></span></code></pre></td></tr></table></div></div><p>å…¶ä¸­ç¬¬ä¸€ä¸ª INTEGER æ˜¯ modulusï¼Œç¬¬äºŒä¸ª INTEGER æ˜¯ exponentã€‚ç”±äºå¯ä»¥ç›´æ¥å¤åˆ¶ï¼Œä¸å†ä½¿ç”¨ xxd å‘½ä»¤ã€‚</p><p>éªŒè¯è¿™ä¸ªä¿¡æ¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>openssl x509 -inform DER -in EncryptionEverywhereDVTLSCA-G1.crt -noout -text
</span></span></code></pre></td></tr></table></div></div><p>åœ¨ <code>Subject Public Key Info</code> ä¸€èŠ‚é‡Œå¯ä»¥çœ‹åˆ°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>00:b3:de:3f:ac:24:69:be:35:77:24:21:ea:62:9c:
</span></span><span class=line><span class=cl>a0:7a:adğŸ‡©ğŸ‡ª34:48:c5:6e:4c:0e:f7:fd:43:28:8e:
</span></span><span class=line><span class=cl>47:b5:5f:17:02:ba:e7:a7:ac:d1:41:62:21:be:f8:
</span></span><span class=line><span class=cl>37:da:51:9e:dc:c5:d5:48:18:cc:31:ae:de:9a:59:
</span></span><span class=line><span class=cl>54:c7:68:95:bc:61:9b:a7:56:4b:d3:8a:fe:51:5e:
</span></span><span class=line><span class=cl>84:a3:53:d0:e6:08:f5:aa:a4:e8:5f:94:ed:c0:3a:
</span></span><span class=line><span class=cl>8f:14:82:fa:20:c1:3d:7c:1d:17:8a:ec:dc:a4:72:
</span></span><span class=line><span class=cl>a7:76:90:9f:aa:63:a6:9d:72:af:b2:01:e9:8e:33:
</span></span><span class=line><span class=cl>bf:bd:84:7b:f3:e5:67:fe:ab:2b:a2:27:0b:a5:a9:
</span></span><span class=line><span class=cl>2b:49:cf:54:e6:11:ee:7f:62:0e:e3ğŸ‡©ğŸ‡ªd4:4e:08:
</span></span><span class=line><span class=cl>c5:43:01:1f:f4:f7:df:ed:e1:ca:e1:f7:76:f7:e0:
</span></span><span class=line><span class=cl>89:65:0e:52:48:dd:a4:c6:f2:c5:7f:97:36:57:b9:
</span></span><span class=line><span class=cl>b8:42:22:c8:1b:22:e0:8b:db:71:30:a1:f2:bb:a2:
</span></span><span class=line><span class=cl>7c:22:22:e6:60:d7:91:9a:e7:31:3f:27:c1:f6:02:
</span></span><span class=line><span class=cl>57ğŸ†fa:90:37:57:91:b8:06:44:b2:ac:47:8a:6e:
</span></span><span class=line><span class=cl>71:b2:6d:6c:aa:88:91:41:b1:b9:92:36:b7:ba:5f:
</span></span><span class=line><span class=cl>7b:02:91:73:99:d6:79:cb:c3:05:97:f7:fa:9d:4c:
</span></span><span class=line><span class=cl>a4:0f
</span></span></code></pre></td></tr></table></div></div><p>ä»¥åŠï¼š Exponent: 65537 (0x10001)ã€‚</p><p>ä¸ä¸Šè¿°è·å–çš„ä¸€è‡´ã€‚</p><h4 id=ä½¿ç”¨-ca-å…¬é’¥è§£å¯†>ä½¿ç”¨ CA å…¬é’¥è§£å¯†</h4><p>å·²çŸ¥çš„å†…å®¹ï¼š</p><ul><li><p>ç­¾åå€¼ sig ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>49aa4a0ff0052f53f27fd1681b11f6247a75b6da247b589a8cec50a7abd3e1ddc9cbbd09a221e529466bdacb34d3bf9555fa4714731b33326cf341d2cd5ac6b5996d22a682dcd8a97ea2245b3318fddc423d17d16318cd925c6d5873a40f16d9b0a6393c18e66d57be6c30688d10faf55b833479cb2735835210c7c6869bc2c33edf7acb531e1e96d3a47796d0f2fe3c3784d3f35e0e7824094bb4b388e8d95861b864a71c50e3b6da9512be585a14196dc7ec2e80f74a06fead44b7340f1a6c3fa1451bd64eadf8ec71d866dee43e44cfcaae3ecc9804e12037400e6548ce77c080d2b09840aa7297aa862679f228a7fac1187a68355946d49a5ae7389d6a38
</span></span></code></pre></td></tr></table></div></div></li><li><p>CA å…¬é’¥ç³»æ•° modulusï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>B3DE3FAC2469BE35772421EA629CA07AADDE3448C56E4C0EF7FD43288E47B55F1702BAE7A7ACD1416221BEF837DA519EDCC5D54818CC31AEDE9A5954C76895BC619BA7564BD38AFE515E84A353D0E608F5AAA4E85F94EDC03A8F1482FA20C13D7C1D178AECDCA472A776909FAA63A69D72AFB201E98E33BFBD847BF3E567FEAB2BA2270BA5A92B49CF54E611EE7F620EE3DED44E08C543011FF4F7DFEDE1CAE1F776F7E089650E5248DDA4C6F2C57F973657B9B84222C81B22E08BDB7130A1F2BBA27C2222E660D7919AE7313F27C1F60257ABFA90375791B80644B2AC478A6E71B26D6CAA889141B1B99236B7BA5F7B02917399D679CBC30597F7FA9D4CA40F
</span></span></code></pre></td></tr></table></div></div></li><li><p>CA å…¬é’¥æŒ‡æ•° exponentï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>0x10001
</span></span></code></pre></td></tr></table></div></div></li></ul><p>æ ¹æ®å…¬å¼ decrypted_value = (modulus^exponent)%sigï¼Œä½¿ç”¨ python è®¡ç®—ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>modulus</span><span class=o>=</span><span class=mh>0xB3DE3FAC2469BE35772421EA629CA07AADDE3448C56E4C0EF7FD43288E47B55F1702BAE7A7ACD1416221BEF837DA519EDCC5D54818CC31AEDE9A5954C76895BC619BA7564BD38AFE515E84A353D0E608F5AAA4E85F94EDC03A8F1482FA20C13D7C1D178AECDCA472A776909FAA63A69D72AFB201E98E33BFBD847BF3E567FEAB2BA2270BA5A92B49CF54E611EE7F620EE3DED44E08C543011FF4F7DFEDE1CAE1F776F7E089650E5248DDA4C6F2C57F973657B9B84222C81B22E08BDB7130A1F2BBA27C2222E660D7919AE7313F27C1F60257ABFA90375791B80644B2AC478A6E71B26D6CAA889141B1B99236B7BA5F7B02917399D679CBC30597F7FA9D4CA40F</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sig</span><span class=o>=</span><span class=mh>0x49aa4a0ff0052f53f27fd1681b11f6247a75b6da247b589a8cec50a7abd3e1ddc9cbbd09a221e529466bdacb34d3bf9555fa4714731b33326cf341d2cd5ac6b5996d22a682dcd8a97ea2245b3318fddc423d17d16318cd925c6d5873a40f16d9b0a6393c18e66d57be6c30688d10faf55b833479cb2735835210c7c6869bc2c33edf7acb531e1e96d3a47796d0f2fe3c3784d3f35e0e7824094bb4b388e8d95861b864a71c50e3b6da9512be585a14196dc7ec2e80f74a06fead44b7340f1a6c3fa1451bd64eadf8ec71d866dee43e44cfcaae3ecc9804e12037400e6548ce77c080d2b09840aa7297aa862679f228a7fac1187a68355946d49a5ae7389d6a38</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>exponent</span><span class=o>=</span><span class=mh>0x10001</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%x</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=nb>pow</span><span class=p>(</span><span class=n>sig</span><span class=p>,</span> <span class=n>exponent</span><span class=p>,</span> <span class=n>modulus</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>å¾—åˆ°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff003031300d060960864801650304020105000420bca9d80920262764ca037b51a1f7bfd8a240c8059c7564dafdaf12ded366d6f5
</span></span></code></pre></td></tr></table></div></div><p>å¼€å¤´çš„ <code>1fff...</code> æ˜¯ RSA ç®—æ³•çš„å¡«å……å­—èŠ‚ï¼Œæ¥ä¸‹æ¥çš„ <code>3031300D060960864801650304020105000420</code> æ˜¯ sha256 çš„å¡«å……å­—èŠ‚ã€‚å‰©ä¸‹çš„ <code>bca9d80920262764ca037b51a1f7bfd8a240c8059c7564dafdaf12ded366d6f5</code> æ˜¯è¯ä¹¦ hash å€¼ã€‚</p><p>æˆ‘ä»¬å°†è¯¥å€¼ä¸å‰é¢æ‰‹åŠ¨è®¡ç®—çš„ TBS è¯ä¹¦ hash å€¼åšå¯¹æ¯”ï¼Œå¾—åˆ°å®Œå…¨ä¸€è‡´ã€‚</p><p>è‡³æ­¤ï¼ŒéªŒè¯å®Œæ¯•ã€‚</p><h3 id=è¯ä¹¦é“¾>è¯ä¹¦é“¾</h3><p>ä¸Šé¢åªéªŒè¯äº†ç¬¬ä¸€æ­¥ã€‚ä»æµè§ˆå™¨ä¸­å¯ä»¥çœ‹å‡ºï¼Œä¸Šè¿° CA è¯ä¹¦ä¸æ˜¯æ ¹è¯ä¹¦ï¼Œè¿˜éœ€è¦éªŒè¯ CA è¯ä¹¦çš„å¯ä¿¡ã€‚æ­¥éª¤ä¸ä¸Šè¿°å·®ä¸å¤šï¼Œåªæ˜¯æ ¹è¯ä¹¦æ˜¯å®‰è£…åœ¨è®¾å¤‡çš„æ“ä½œç³»ç»Ÿä¸Šæˆ–è€…æµè§ˆå™¨ä¸Šã€‚</p><h2 id=å‚è€ƒ>å‚è€ƒ</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[1]: https://blog.yuantops.com/tech/validate_a_digital_certificate_step_by_step/ (æ‰‹å·¥éªŒè¯ä¸€å¼ æ•°å­—è¯ä¹¦çš„æœ‰æ•ˆæ€§)
</span></span><span class=line><span class=cl>[2]: https://yongbingchen.github.io/blog/2015/04/09/verify-the-signature-of-a-x-dot-509-certificate/ (https://yongbingchen.github.io/blog/2015/04/09/verify-the-signature-of-a-x-dot-509-certificate/)
</span></span><span class=line><span class=cl>[3]: https://datatracker.ietf.org/doc/html/rfc3279 (RFC 3279) 
</span></span><span class=line><span class=cl>[4]: https://datatracker.ietf.org/doc/html/rfc2313 (RFC 2313)
</span></span><span class=line><span class=cl>[5]: https://datatracker.ietf.org/doc/html/rfc3280 (RFC 3280)
</span></span><span class=line><span class=cl>[6]: https://docs.microsoft.com/en-us/windows/win32/seccertenroll/about-encoded-length-and-value-bytes (Encoded Length and Value Bytes)
</span></span><span class=line><span class=cl>[7]: https://linux.die.net/man/1/asn1parse (asn1parse(1) - Linux man page)
</span></span><span class=line><span class=cl>[8]: https://stackoverflow.com/questions/2614764/how-to-create-a-hex-dump-of-file-containing-only-the-hex-characters-without-spac (How to create a hex dump of file containing only the hex characters without spaces in bash?)
</span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>æ›´æ–°äº 2022-05-10</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/2022/05/10/cert-verify/index.md target=_blank>é˜…è¯»åŸå§‹æ–‡æ¡£</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="åˆ†äº«åˆ° Twitter" data-sharer=twitter data-url=https://schaepher.github.io/2022/05/10/cert-verify/ data-title="æ‰‹åŠ¨éªŒè¯ TLS è¯ä¹¦" data-hashtags=HTTPS,TLS><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="åˆ†äº«åˆ° Facebook" data-sharer=facebook data-url=https://schaepher.github.io/2022/05/10/cert-verify/ data-hashtag=HTTPS><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="åˆ†äº«åˆ° Hacker News" data-sharer=hackernews data-url=https://schaepher.github.io/2022/05/10/cert-verify/ data-title="æ‰‹åŠ¨éªŒè¯ TLS è¯ä¹¦"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="åˆ†äº«åˆ° Line" data-sharer=line data-url=https://schaepher.github.io/2022/05/10/cert-verify/ data-title="æ‰‹åŠ¨éªŒè¯ TLS è¯ä¹¦"><i data-svg-src=/lib/simple-icons/icons/line.min.svg aria-hidden=true></i></a><a href=javascript:void(0); title="åˆ†äº«åˆ° å¾®åš" data-sharer=weibo data-url=https://schaepher.github.io/2022/05/10/cert-verify/ data-title="æ‰‹åŠ¨éªŒè¯ TLS è¯ä¹¦"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="åˆ†äº«åˆ° Evernote" data-sharer=evernote data-url=https://schaepher.github.io/2022/05/10/cert-verify/ data-title="æ‰‹åŠ¨éªŒè¯ TLS è¯ä¹¦"><i class="fab fa-evernote fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/https/>HTTPS</a>,&nbsp;<a href=/tags/tls/>TLS</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>è¿”å›</a></span>&nbsp;|&nbsp;<span><a href=/>ä¸»é¡µ</a></span></section></div><div class=post-nav><a href=/2022/05/08/2022-life-part1/ class=prev rel=prev title="é£æš´è¿‡å»äº†ï¼Œä½†æœ‰æ–°çš„æŒ‘æˆ˜ â€”â€” 2022 çš„ä¸‰åˆ†ä¹‹ä¸€"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>é£æš´è¿‡å»äº†ï¼Œä½†æœ‰æ–°çš„æŒ‘æˆ˜ â€”â€” 2022 çš„ä¸‰åˆ†ä¹‹ä¸€</a>
<a href=/2022/05/11/tree-rotation/ class=next rel=next title=å› ä¸ºä¸€å¥è¯ï¼Œç§’æ‡‚äºŒå‰æ ‘æ—‹è½¬>å› ä¸ºä¸€å¥è¯ï¼Œç§’æ‡‚äºŒå‰æ ‘æ—‹è½¬<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>ç”± <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.101.0">Hugo</a> å¼ºåŠ›é©±åŠ¨ | ä¸»é¢˜ - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2017 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://cnblogs.com/schaepher target=_blank>Schaepher</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=å›åˆ°é¡¶éƒ¨><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title=æŸ¥çœ‹è¯„è®º><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/katex/katex.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/lib/lunr/lunr.zh.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/contrib/auto-render.min.js></script><script type=text/javascript src=/lib/katex/contrib/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"å¤åˆ¶åˆ°å‰ªè´´æ¿",maxShownLines:50},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",lunrLanguageCode:"zh",lunrSegmentitURL:"/lib/lunr/lunr.segmentit.js",maxResultLength:10,noResultsFound:"æ²¡æœ‰æ‰¾åˆ°ç»“æœ",snippetLength:50,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>