<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"schaepher.github.io","root":"/","scheme":"Gemini","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gittalk","storage":true,"lazyload":false,"nav":{"gitalk":"Load Gitalk"}},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="证书验证证书结构我们现在使用的 TLS 证书的标准是 X.509，版本号为 V3。版本号可从证书的 Version 字段看到。 根据 RFC 3280 定义的证书结构，证书由三个部分组成：  证书主体（TBSCertificate，To Be Signed Certificate，待签名证书）   签名算法 签名值">
<meta property="og:type" content="article">
<meta property="og:title" content="手动验证 TLS 证书">
<meta property="og:url" content="https://schaepher.github.io/2022/05/10/cert-verify/index.html">
<meta property="og:site_name" content="Schaepher&#39;s Blog">
<meta property="og:description" content="证书验证证书结构我们现在使用的 TLS 证书的标准是 X.509，版本号为 V3。版本号可从证书的 Version 字段看到。 根据 RFC 3280 定义的证书结构，证书由三个部分组成：  证书主体（TBSCertificate，To Be Signed Certificate，待签名证书）   签名算法 签名值">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-05-10T12:30:00.000Z">
<meta property="article:modified_time" content="2022-05-10T12:30:00.000Z">
<meta property="article:author" content="Schaepher">
<meta property="article:tag" content="HTTPS">
<meta property="article:tag" content="TLS">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://schaepher.github.io/2022/05/10/cert-verify/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>手动验证 TLS 证书 | Schaepher's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Schaepher's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="search-pop-overlay">
  <div class="popup search-popup">
      <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

  </div>
</div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/schaepher" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://schaepher.github.io/2022/05/10/cert-verify/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/theme/avatar.png">
      <meta itemprop="name" content="Schaepher">
      <meta itemprop="description" content="深透理解，熟练运用。<br>似懂非懂，其实不懂。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Schaepher's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          手动验证 TLS 证书
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-05-10 12:30:00" itemprop="dateCreated datePublished" datetime="2022-05-10T12:30:00+00:00">2022-05-10</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="证书验证"><a href="#证书验证" class="headerlink" title="证书验证"></a>证书验证</h2><h3 id="证书结构"><a href="#证书结构" class="headerlink" title="证书结构"></a>证书结构</h3><p>我们现在使用的 TLS 证书的标准是 X.509，版本号为 V3。版本号可从证书的 Version 字段看到。</p>
<p>根据 <a href="https://datatracker.ietf.org/doc/html/rfc3280.html?msclkid=a0a5d923cf8211ec99debd4d1b18e2b5#section-4.1" target="_blank" rel="noopener">RFC 3280</a> 定义的证书结构，证书由三个部分组成：</p>
<ol>
<li>证书主体（TBSCertificate，To Be Signed Certificate，待签名证书）  </li>
<li>签名算法</li>
<li>签名值</li>
</ol>
<a id="more"></a>

<p>证书主体包括版本、序列号、公钥等内容。签名值是对证书主体使用签名算法计算并经过证书签名机构私钥加密后的值。</p>
<p>证书的数据组织格式为 ASN.1 DER 格式（distinguished encoding rules）。这是一种 TLV 编码，其中的每个元素都包含 Tag、Length、Value。通常我们获得的证书是经由 Base64 编码后的 PEM 文件，为了节省不必要的麻烦，后续内容会提前将证书转回 DER 格式。</p>
<p>PEM 文件的格式是这样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line">这里是 Base64 编码后的内容</span><br><span class="line">-----END CERTIFICATE-----</span><br></pre></td></tr></table></figure>

<h3 id="证书验证-1"><a href="#证书验证-1" class="headerlink" title="证书验证"></a>证书验证</h3><p>为了验证证书，我们需要获取以下内容：</p>
<ol>
<li>证书主体。用于通过签名算法得到其 hash 值</li>
<li>证书签名值。</li>
<li>CA 的公钥。用于解密签名，得到证书主体的 hash 值</li>
</ol>
<p>如果 1 和 3 的 hash 值相等，则说明此次验证通过。</p>
<p>我们以博客园的证书为例。</p>
<h4 id="证书下载"><a href="#证书下载" class="headerlink" title="证书下载"></a>证书下载</h4><ol>
<li>下载博客园证书  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">   <span class="built_in">echo</span> -n | openssl s_client -connect www.cnblogs.com:443 | openssl x509 -outform DER &gt; www.cnblogs.com.crt</span><br><span class="line">   ```  </span><br><span class="line">   证书原文是用 Base64 编码后的 PEM 格式文件，这里将其直接转换为 DER 格式。</span><br><span class="line">2. 查看博客园的 CA 证书地址  </span><br><span class="line">   ```bash</span><br><span class="line">   openssl x509 -inform DER -<span class="keyword">in</span> www.cnblogs.com.crt -noout -text  | grep <span class="string">"CA Issuers"</span></span><br><span class="line">   ```  </span><br><span class="line">   得到：</span><br><span class="line">   ```bash</span><br><span class="line">   CA Issuers - URI:http://cacerts.digicert.com/EncryptionEverywhereDVTLSCA-G1.crt</span><br></pre></td></tr></table></figure></li>
<li>下载 CA 证书  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">   curl -O http://cacerts.digicert.com/EncryptionEverywhereDVTLSCA-G1.crt</span><br><span class="line">   ```  </span><br><span class="line">   这个证书已经是 DER 格式，无需转换。</span><br><span class="line"></span><br><span class="line">现在，我们得到了：</span><br><span class="line"></span><br><span class="line">- 博客园证书</span><br><span class="line">- 给博客园证书签名的 CA 的证书</span><br><span class="line"></span><br><span class="line"><span class="comment">#### DER 证书解析</span></span><br><span class="line"></span><br><span class="line">在开始验证之前，再次了解证书的格式，便于理解后续的获取操作。</span><br><span class="line"></span><br><span class="line">证书由证书主体、签名算法和签名值三个部分组成。DER 格式每个元素以 SEQUENCE 作为开头。由于完整的证书是一个 SEQUENCE，因此证书最外层有个 SEQUENCE。里面三个部分都各自有一个 SEQUENCE。</span><br><span class="line"></span><br><span class="line">执行命令查看内容：</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">openssl asn1parse -i -inform DER -<span class="keyword">in</span> www.cnblogs.com.crt</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>解析的格式为：开头数字是偏移量，d 表示深度（depth），d 相同的表示是同一个层级。hl 表示头部长度（header length），l 表示不包含头部的数据长度（lenght）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">   0:d&#x3D;0  hl&#x3D;4 l&#x3D;1534 cons: SEQUENCE</span><br><span class="line">   4:d&#x3D;1  hl&#x3D;4 l&#x3D;1254 cons:  SEQUENCE</span><br><span class="line">   8:d&#x3D;2  hl&#x3D;2 l&#x3D;   3 cons:   cont [ 0 ]</span><br><span class="line">  10:d&#x3D;3  hl&#x3D;2 l&#x3D;   1 prim:    INTEGER           :02</span><br><span class="line">  13:d&#x3D;2  hl&#x3D;2 l&#x3D;  16 prim:   INTEGER           :03E3AC5347CD4A3862C2855A71A6F94F</span><br><span class="line">  31:d&#x3D;2  hl&#x3D;2 l&#x3D;  13 cons:   SEQUENCE</span><br><span class="line">  33:d&#x3D;3  hl&#x3D;2 l&#x3D;   9 prim:    OBJECT            :sha256WithRSAEncryption</span><br><span class="line">  44:d&#x3D;3  hl&#x3D;2 l&#x3D;   0 prim:    NULL</span><br><span class="line">  46:d&#x3D;2  hl&#x3D;2 l&#x3D; 110 cons:   SEQUENCE</span><br><span class="line">  48:d&#x3D;3  hl&#x3D;2 l&#x3D;  11 cons:    SET</span><br><span class="line">  50:d&#x3D;4  hl&#x3D;2 l&#x3D;   9 cons:     SEQUENCE</span><br><span class="line">  52:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :countryName</span><br><span class="line">  57:d&#x3D;5  hl&#x3D;2 l&#x3D;   2 prim:      PRINTABLESTRING   :US</span><br><span class="line">  61:d&#x3D;3  hl&#x3D;2 l&#x3D;  21 cons:    SET</span><br><span class="line">  63:d&#x3D;4  hl&#x3D;2 l&#x3D;  19 cons:     SEQUENCE</span><br><span class="line">  65:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :organizationName</span><br><span class="line">  70:d&#x3D;5  hl&#x3D;2 l&#x3D;  12 prim:      PRINTABLESTRING   :DigiCert Inc</span><br><span class="line">  84:d&#x3D;3  hl&#x3D;2 l&#x3D;  25 cons:    SET</span><br><span class="line">  86:d&#x3D;4  hl&#x3D;2 l&#x3D;  23 cons:     SEQUENCE</span><br><span class="line">  88:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :organizationalUnitName</span><br><span class="line">  93:d&#x3D;5  hl&#x3D;2 l&#x3D;  16 prim:      PRINTABLESTRING   :www.digicert.com</span><br><span class="line"> 111:d&#x3D;3  hl&#x3D;2 l&#x3D;  45 cons:    SET</span><br><span class="line"> 113:d&#x3D;4  hl&#x3D;2 l&#x3D;  43 cons:     SEQUENCE</span><br><span class="line"> 115:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :commonName</span><br><span class="line"> 120:d&#x3D;5  hl&#x3D;2 l&#x3D;  36 prim:      PRINTABLESTRING   :Encryption Everywhere DV TLS CA - G1</span><br><span class="line"> 158:d&#x3D;2  hl&#x3D;2 l&#x3D;  30 cons:   SEQUENCE</span><br><span class="line"> 160:d&#x3D;3  hl&#x3D;2 l&#x3D;  13 prim:    UTCTIME           :220228000000Z</span><br><span class="line"> 175:d&#x3D;3  hl&#x3D;2 l&#x3D;  13 prim:    UTCTIME           :230301235959Z</span><br><span class="line"> 190:d&#x3D;2  hl&#x3D;2 l&#x3D;  24 cons:   SEQUENCE</span><br><span class="line"> 192:d&#x3D;3  hl&#x3D;2 l&#x3D;  22 cons:    SET</span><br><span class="line"> 194:d&#x3D;4  hl&#x3D;2 l&#x3D;  20 cons:     SEQUENCE</span><br><span class="line"> 196:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :commonName</span><br><span class="line"> 201:d&#x3D;5  hl&#x3D;2 l&#x3D;  13 prim:      UTF8STRING        :*.cnblogs.com</span><br><span class="line"> 216:d&#x3D;2  hl&#x3D;4 l&#x3D; 290 cons:   SEQUENCE</span><br><span class="line"> 220:d&#x3D;3  hl&#x3D;2 l&#x3D;  13 cons:    SEQUENCE</span><br><span class="line"> 222:d&#x3D;4  hl&#x3D;2 l&#x3D;   9 prim:     OBJECT            :rsaEncryption</span><br><span class="line"> 233:d&#x3D;4  hl&#x3D;2 l&#x3D;   0 prim:     NULL</span><br><span class="line"> 235:d&#x3D;3  hl&#x3D;4 l&#x3D; 271 prim:    BIT STRING</span><br><span class="line"> 510:d&#x3D;2  hl&#x3D;4 l&#x3D; 748 cons:   cont [ 3 ]</span><br><span class="line"> 514:d&#x3D;3  hl&#x3D;4 l&#x3D; 744 cons:    SEQUENCE</span><br><span class="line"> 518:d&#x3D;4  hl&#x3D;2 l&#x3D;  31 cons:     SEQUENCE</span><br><span class="line"> 520:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :X509v3 Authority Key Identifier</span><br><span class="line"> 525:d&#x3D;5  hl&#x3D;2 l&#x3D;  24 prim:      OCTET STRING      [HEX DUMP]:3016801455744FB2724FF560BA50D1D7E6515C9A01871AD7</span><br><span class="line"> 551:d&#x3D;4  hl&#x3D;2 l&#x3D;  29 cons:     SEQUENCE</span><br><span class="line"> 553:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :X509v3 Subject Key Identifier</span><br><span class="line"> 558:d&#x3D;5  hl&#x3D;2 l&#x3D;  22 prim:      OCTET STRING      [HEX DUMP]:04149DE559358AA4C25E1A52193A745F007F101B1C17</span><br><span class="line"> 582:d&#x3D;4  hl&#x3D;2 l&#x3D;  37 cons:     SEQUENCE</span><br><span class="line"> 584:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :X509v3 Subject Alternative Name</span><br><span class="line"> 589:d&#x3D;5  hl&#x3D;2 l&#x3D;  30 prim:      OCTET STRING      [HEX DUMP]:301C820D2A2E636E626C6F67732E636F6D820B636E626C6F67732E636F6D</span><br><span class="line"> 621:d&#x3D;4  hl&#x3D;2 l&#x3D;  14 cons:     SEQUENCE</span><br><span class="line"> 623:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :X509v3 Key Usage</span><br><span class="line"> 628:d&#x3D;5  hl&#x3D;2 l&#x3D;   1 prim:      BOOLEAN           :255</span><br><span class="line"> 631:d&#x3D;5  hl&#x3D;2 l&#x3D;   4 prim:      OCTET STRING      [HEX DUMP]:030205A0</span><br><span class="line"> 637:d&#x3D;4  hl&#x3D;2 l&#x3D;  29 cons:     SEQUENCE</span><br><span class="line"> 639:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :X509v3 Extended Key Usage</span><br><span class="line"> 644:d&#x3D;5  hl&#x3D;2 l&#x3D;  22 prim:      OCTET STRING      [HEX DUMP]:301406082B0601050507030106082B06010505070302</span><br><span class="line"> 668:d&#x3D;4  hl&#x3D;2 l&#x3D;  62 cons:     SEQUENCE</span><br><span class="line"> 670:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :X509v3 Certificate Policies</span><br><span class="line"> 675:d&#x3D;5  hl&#x3D;2 l&#x3D;  55 prim:      OCTET STRING      [HEX DUMP]:30353033060667810C0102013029302706082B06010505070201161B687474703A2F2F7777772E64696769636572742E636F6D2F435053</span><br><span class="line"> 732:d&#x3D;4  hl&#x3D;3 l&#x3D; 128 cons:     SEQUENCE</span><br><span class="line"> 735:d&#x3D;5  hl&#x3D;2 l&#x3D;   8 prim:      OBJECT            :Authority Information Access</span><br><span class="line"> 745:d&#x3D;5  hl&#x3D;2 l&#x3D; 116 prim:      OCTET STRING      [HEX DUMP]:3072302406082B060105050730018618687474703A2F2F6F6373702E64696769636572742E636F6D304A06082B06010505073002863E687474703A2F2F636163657274732E64696769636572742E636F6D2F456E6372797074696F6E457665727977686572654456544C5343412D47312E637274</span><br><span class="line"> 863:d&#x3D;4  hl&#x3D;2 l&#x3D;   9 cons:     SEQUENCE</span><br><span class="line"> 865:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :X509v3 Basic Constraints</span><br><span class="line"> 870:d&#x3D;5  hl&#x3D;2 l&#x3D;   2 prim:      OCTET STRING      [HEX DUMP]:3000</span><br><span class="line"> 874:d&#x3D;4  hl&#x3D;4 l&#x3D; 384 cons:     SEQUENCE</span><br><span class="line"> 878:d&#x3D;5  hl&#x3D;2 l&#x3D;  10 prim:      OBJECT            :CT Precertificate SCTs</span><br><span class="line"> 890:d&#x3D;5  hl&#x3D;4 l&#x3D; 368 prim:      OCTET STRING      [HEX DUMP]:0482016C016A007700E83ED0DA3EF5063532E75728BC896BC903D3CBD1116BECEB69E1777D6D06BD6E0000017F3E1A44D10000040300483046022100D8162F949F2820F1C3CCF73AD2826F04CDD3EA09C16BAD2441AE07C69D149DE1022100AC4C3B8EB60C5613C32B85C5303ACC67F62888DFB7925861088B21B550E16E9600760035CF191BBFB16C57BF0FAD4C6D42CBBBB627202651EA3FE12AEFA803C33BD64C0000017F3E1A45110000040300473045022100A4D6915799132F3997B16F009F7011520A3BB30A040DAE42B73D905975DBADBD02206165D6DA0CB72F87B8FA7F309806919893FA962126F6D94512DB700CDF019B84007700B3737707E18450F86386D605A9DC11094A792DB1670C0B87DCF0030E7936A59A0000017F3E1A45370000040300483046022100B31A83931E8A4D8BD4FD2F28E8C42D3B1083D79E9F5E7F9F8B8D1C4D33DE8C65022100E6D91B7986CA850272265DEDBD4C40180BB73B69447304F423BDA19B29F4ADE3</span><br><span class="line">1262:d&#x3D;1  hl&#x3D;2 l&#x3D;  13 cons:  SEQUENCE</span><br><span class="line">1264:d&#x3D;2  hl&#x3D;2 l&#x3D;   9 prim:   OBJECT            :sha256WithRSAEncryption</span><br><span class="line">1275:d&#x3D;2  hl&#x3D;2 l&#x3D;   0 prim:   NULL</span><br><span class="line">1277:d&#x3D;1  hl&#x3D;4 l&#x3D; 257 prim:  BIT STRING</span><br></pre></td></tr></table></figure>

<p>例如第一行：<br><code>0:d=0  hl=4 l=1534 cons: SEQUENCE</code></p>
<p>开头 0 表示偏移量为 0，就是整个文件的开头。d=0 表示最顶层，为整个证书的对象。头部长度为 4 字节，数据字段（也就是三个部分）总共 1534 字节，加起来整个文件共 1538 字节。</p>
<p>再看最后一行，</p>
<p><code>1277:d=1  hl=4 l= 257 prim:  BIT STRING</code></p>
<p>开头 1277 表示偏移量，d=1 表示顶层的下一层，而这个位置在最后一部分，那么就代表是签名值。头部长度为 4 字节，数据长度为 257 字节，加起来共 261 字节。加上偏移量 1277 + 261 = 1538 字节，与第一行的计算结果吻合。</p>
<h4 id="获取证书主体（待签名证书）"><a href="#获取证书主体（待签名证书）" class="headerlink" title="获取证书主体（待签名证书）"></a>获取证书主体（待签名证书）</h4><p>根据定义，第一个部分就是待签名证书。因此从第一个 d=1 的地方开始，即文件的第二行。</p>
<p><code>4:d=1  hl=4 l=1254 cons:  SEQUENCE</code></p>
<p>表示偏移量为 4，头部 4 字节，数据 1254 字节。hash 的时候会连头部都算上，所以总共获取 1258 字节。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dd <span class="keyword">if</span>=www.cnblogs.com.crt of=www.cnblogs.com.tbs bs=1 skip=4 count=1258</span><br></pre></td></tr></table></figure>

<p>这里 bs=1 表示每次读取一个字节，count 表示读取 1258 次，两者组合起来就是读取 1258 个字节。</p>
<h4 id="计算证书-hash-值"><a href="#计算证书-hash-值" class="headerlink" title="计算证书 hash 值"></a>计算证书 hash 值</h4><p>获取签名和加密算法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -inform DER -in www.cnblogs.com.crt -noout -text | grep &#39;Signature Algorithm&#39; | tail -n 1</span><br></pre></td></tr></table></figure>

<p>sha256WithRSAEncryption 表示使用 sha256 hash，并使用 RSA 加密。</p>
<p>计算：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sha256sum www.cnblogs.com.tbs</span><br></pre></td></tr></table></figure>

<p>得到结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bca9d80920262764ca037b51a1f7bfd8a240c8059c7564dafdaf12ded366d6f5  www.cnblogs.com.tbs</span><br></pre></td></tr></table></figure>

<h4 id="签名值"><a href="#签名值" class="headerlink" title="签名值"></a>签名值</h4><p>从 ASN.1 解析后的数据，可以知道签名值的偏移量是 1277。</p>
<p>截取签名值：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl asn1parse  -inform DER -<span class="keyword">in</span> www.cnblogs.com.crt --strparse 1277 -noout -out www.cnblogs.com.sig</span><br></pre></td></tr></table></figure>

<p>验证这个数据：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xxd -p www.cnblogs.com.sig  | tr -d <span class="string">'\n'</span></span><br></pre></td></tr></table></figure>

<p>得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">49aa4a0ff0052f53f27fd1681b11f6247a75b6da247b589a8cec50a7abd3e1ddc9cbbd09a221e529466bdacb34d3bf9555fa4714731b33326cf341d2cd5ac6b5996d22a682dcd8a97ea2245b3318fddc423d17d16318cd925c6d5873a40f16d9b0a6393c18e66d57be6c30688d10faf55b833479cb2735835210c7c6869bc2c33edf7acb531e1e96d3a47796d0f2fe3c3784d3f35e0e7824094bb4b388e8d95861b864a71c50e3b6da9512be585a14196dc7ec2e80f74a06fead44b7340f1a6c3fa1451bd64eadf8ec71d866dee43e44cfcaae3ecc9804e12037400e6548ce77c080d2b09840aa7297aa862679f228a7fac1187a68355946d49a5ae7389d6a38</span><br></pre></td></tr></table></figure>


<p>查看得到的结果是否与以下命令的最后一部分一致：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -inform DER -<span class="keyword">in</span> www.cnblogs.com.crt -noout -text</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">49:aa:4a:0f:f0:05:2f:53:f2:7f:d1:68:1b:11:f6:24:7a:75:</span><br><span class="line">b6:da:24:7b:58:9a:8c:ec:50:a7:ab:d3:e1:dd:c9:cb:bd:09:</span><br><span class="line">a2:21:e5:29:46:6b:da:cb:34:d3:bf:95:55:fa:47:14:73:1b:</span><br><span class="line">33:32:6c:f3:41:d2:cd:5a:c6:b5:99:6d:22:a6:82:dc:d8:a9:</span><br><span class="line">7e:a2:24:5b:33:18:fd:dc:42:3d:17:d1:63:18:cd:92:5c:6d:</span><br><span class="line">58:73:a4:0f:16:d9:b0:a6:39:3c:18:e6:6d:57:be:6c:30:68:</span><br><span class="line">8d:10:fa:f5:5b:83:34:79:cb:27:35:83:52:10:c7:c6:86:9b:</span><br><span class="line">c2:c3:3e:df:7a:cb:53:1e:1e:96:d3:a4:77:96:d0:f2:fe:3c:</span><br><span class="line">37:84:d3:f3:5e:0e:78:24:09:4b:b4:b3:88:e8:d9:58:61:b8:</span><br><span class="line">64:a7:1c:50:e3:b6:da:95:12:be:58:5a:14:19:6d:c7:ec:2e:</span><br><span class="line">80:f7:4a:06:fe:ad:44:b7:34:0f:1a:6c:3f:a1:45:1b:d6:4e:</span><br><span class="line">ad:f8:ec:71:d8:66:de:e4:3e:44:cf:ca:ae:3e:cc:98:04:e1:</span><br><span class="line">20:37:40:0e:65:48:ce:77:c0:80:d2:b0:98:40:aa:72:97:aa:</span><br><span class="line">86:26:79:f2:28:a7:fa:c1:18:7a:68:35:59:46:d4:9a:5a:e7:</span><br><span class="line">38:9d:6a:38</span><br></pre></td></tr></table></figure>

<p>这部分直接从完整的 text 中复制然后手动编辑也可以。</p>
<h4 id="CA-证书公钥"><a href="#CA-证书公钥" class="headerlink" title="CA 证书公钥"></a>CA 证书公钥</h4><p>解析并查看位置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl asn1parse -i -inform DER -<span class="keyword">in</span> EncryptionEverywhereDVTLSCA-G1.crt</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">  0:d&#x3D;0  hl&#x3D;4 l&#x3D;1194 cons: SEQUENCE</span><br><span class="line">  4:d&#x3D;1  hl&#x3D;4 l&#x3D; 914 cons:  SEQUENCE</span><br><span class="line">  8:d&#x3D;2  hl&#x3D;2 l&#x3D;   3 cons:   cont [ 0 ]</span><br><span class="line"> 10:d&#x3D;3  hl&#x3D;2 l&#x3D;   1 prim:    INTEGER           :02</span><br><span class="line"> 13:d&#x3D;2  hl&#x3D;2 l&#x3D;  16 prim:   INTEGER           :0279AC458BC1B245ABF98053CD2C9BB1</span><br><span class="line"> 31:d&#x3D;2  hl&#x3D;2 l&#x3D;  13 cons:   SEQUENCE</span><br><span class="line"> 33:d&#x3D;3  hl&#x3D;2 l&#x3D;   9 prim:    OBJECT            :sha256WithRSAEncryption</span><br><span class="line"> 44:d&#x3D;3  hl&#x3D;2 l&#x3D;   0 prim:    NULL</span><br><span class="line"> 46:d&#x3D;2  hl&#x3D;2 l&#x3D;  97 cons:   SEQUENCE</span><br><span class="line"> 48:d&#x3D;3  hl&#x3D;2 l&#x3D;  11 cons:    SET</span><br><span class="line"> 50:d&#x3D;4  hl&#x3D;2 l&#x3D;   9 cons:     SEQUENCE</span><br><span class="line"> 52:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :countryName</span><br><span class="line"> 57:d&#x3D;5  hl&#x3D;2 l&#x3D;   2 prim:      PRINTABLESTRING   :US</span><br><span class="line"> 61:d&#x3D;3  hl&#x3D;2 l&#x3D;  21 cons:    SET</span><br><span class="line"> 63:d&#x3D;4  hl&#x3D;2 l&#x3D;  19 cons:     SEQUENCE</span><br><span class="line"> 65:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :organizationName</span><br><span class="line"> 70:d&#x3D;5  hl&#x3D;2 l&#x3D;  12 prim:      PRINTABLESTRING   :DigiCert Inc</span><br><span class="line"> 84:d&#x3D;3  hl&#x3D;2 l&#x3D;  25 cons:    SET</span><br><span class="line"> 86:d&#x3D;4  hl&#x3D;2 l&#x3D;  23 cons:     SEQUENCE</span><br><span class="line"> 88:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :organizationalUnitName</span><br><span class="line"> 93:d&#x3D;5  hl&#x3D;2 l&#x3D;  16 prim:      PRINTABLESTRING   :www.digicert.com</span><br><span class="line">111:d&#x3D;3  hl&#x3D;2 l&#x3D;  32 cons:    SET</span><br><span class="line">113:d&#x3D;4  hl&#x3D;2 l&#x3D;  30 cons:     SEQUENCE</span><br><span class="line">115:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :commonName</span><br><span class="line">120:d&#x3D;5  hl&#x3D;2 l&#x3D;  23 prim:      PRINTABLESTRING   :DigiCert Global Root CA</span><br><span class="line">145:d&#x3D;2  hl&#x3D;2 l&#x3D;  30 cons:   SEQUENCE</span><br><span class="line">147:d&#x3D;3  hl&#x3D;2 l&#x3D;  13 prim:    UTCTIME           :171127124610Z</span><br><span class="line">162:d&#x3D;3  hl&#x3D;2 l&#x3D;  13 prim:    UTCTIME           :271127124610Z</span><br><span class="line">177:d&#x3D;2  hl&#x3D;2 l&#x3D; 110 cons:   SEQUENCE</span><br><span class="line">179:d&#x3D;3  hl&#x3D;2 l&#x3D;  11 cons:    SET</span><br><span class="line">181:d&#x3D;4  hl&#x3D;2 l&#x3D;   9 cons:     SEQUENCE</span><br><span class="line">183:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :countryName</span><br><span class="line">188:d&#x3D;5  hl&#x3D;2 l&#x3D;   2 prim:      PRINTABLESTRING   :US</span><br><span class="line">192:d&#x3D;3  hl&#x3D;2 l&#x3D;  21 cons:    SET</span><br><span class="line">194:d&#x3D;4  hl&#x3D;2 l&#x3D;  19 cons:     SEQUENCE</span><br><span class="line">196:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :organizationName</span><br><span class="line">201:d&#x3D;5  hl&#x3D;2 l&#x3D;  12 prim:      PRINTABLESTRING   :DigiCert Inc</span><br><span class="line">215:d&#x3D;3  hl&#x3D;2 l&#x3D;  25 cons:    SET</span><br><span class="line">217:d&#x3D;4  hl&#x3D;2 l&#x3D;  23 cons:     SEQUENCE</span><br><span class="line">219:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :organizationalUnitName</span><br><span class="line">224:d&#x3D;5  hl&#x3D;2 l&#x3D;  16 prim:      PRINTABLESTRING   :www.digicert.com</span><br><span class="line">242:d&#x3D;3  hl&#x3D;2 l&#x3D;  45 cons:    SET</span><br><span class="line">244:d&#x3D;4  hl&#x3D;2 l&#x3D;  43 cons:     SEQUENCE</span><br><span class="line">246:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :commonName</span><br><span class="line">251:d&#x3D;5  hl&#x3D;2 l&#x3D;  36 prim:      PRINTABLESTRING   :Encryption Everywhere DV TLS CA - G1</span><br><span class="line">289:d&#x3D;2  hl&#x3D;4 l&#x3D; 290 cons:   SEQUENCE</span><br><span class="line">293:d&#x3D;3  hl&#x3D;2 l&#x3D;  13 cons:    SEQUENCE</span><br><span class="line">295:d&#x3D;4  hl&#x3D;2 l&#x3D;   9 prim:     OBJECT            :rsaEncryption</span><br><span class="line">306:d&#x3D;4  hl&#x3D;2 l&#x3D;   0 prim:     NULL</span><br><span class="line">308:d&#x3D;3  hl&#x3D;4 l&#x3D; 271 prim:    BIT STRING</span><br><span class="line">583:d&#x3D;2  hl&#x3D;4 l&#x3D; 335 cons:   cont [ 3 ]</span><br><span class="line">587:d&#x3D;3  hl&#x3D;4 l&#x3D; 331 cons:    SEQUENCE</span><br><span class="line">591:d&#x3D;4  hl&#x3D;2 l&#x3D;  29 cons:     SEQUENCE</span><br><span class="line">593:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :X509v3 Subject Key Identifier</span><br><span class="line">598:d&#x3D;5  hl&#x3D;2 l&#x3D;  22 prim:      OCTET STRING      [HEX DUMP]:041455744FB2724FF560BA50D1D7E6515C9A01871AD7</span><br><span class="line">622:d&#x3D;4  hl&#x3D;2 l&#x3D;  31 cons:     SEQUENCE</span><br><span class="line">624:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :X509v3 Authority Key Identifier</span><br><span class="line">629:d&#x3D;5  hl&#x3D;2 l&#x3D;  24 prim:      OCTET STRING      [HEX DUMP]:3016801403DE503556D14CBB66F0A3E21B1BC397B23DD155</span><br><span class="line">655:d&#x3D;4  hl&#x3D;2 l&#x3D;  14 cons:     SEQUENCE</span><br><span class="line">657:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :X509v3 Key Usage</span><br><span class="line">662:d&#x3D;5  hl&#x3D;2 l&#x3D;   1 prim:      BOOLEAN           :255</span><br><span class="line">665:d&#x3D;5  hl&#x3D;2 l&#x3D;   4 prim:      OCTET STRING      [HEX DUMP]:03020186</span><br><span class="line">671:d&#x3D;4  hl&#x3D;2 l&#x3D;  29 cons:     SEQUENCE</span><br><span class="line">673:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :X509v3 Extended Key Usage</span><br><span class="line">678:d&#x3D;5  hl&#x3D;2 l&#x3D;  22 prim:      OCTET STRING      [HEX DUMP]:301406082B0601050507030106082B06010505070302</span><br><span class="line">702:d&#x3D;4  hl&#x3D;2 l&#x3D;  18 cons:     SEQUENCE</span><br><span class="line">704:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :X509v3 Basic Constraints</span><br><span class="line">709:d&#x3D;5  hl&#x3D;2 l&#x3D;   1 prim:      BOOLEAN           :255</span><br><span class="line">712:d&#x3D;5  hl&#x3D;2 l&#x3D;   8 prim:      OCTET STRING      [HEX DUMP]:30060101FF020100</span><br><span class="line">722:d&#x3D;4  hl&#x3D;2 l&#x3D;  52 cons:     SEQUENCE</span><br><span class="line">724:d&#x3D;5  hl&#x3D;2 l&#x3D;   8 prim:      OBJECT            :Authority Information Access</span><br><span class="line">734:d&#x3D;5  hl&#x3D;2 l&#x3D;  40 prim:      OCTET STRING      [HEX DUMP]:3026302406082B060105050730018618687474703A2F2F6F6373702E64696769636572742E636F6D</span><br><span class="line">776:d&#x3D;4  hl&#x3D;2 l&#x3D;  66 cons:     SEQUENCE</span><br><span class="line">778:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :X509v3 CRL Distribution Points</span><br><span class="line">783:d&#x3D;5  hl&#x3D;2 l&#x3D;  59 prim:      OCTET STRING      [HEX DUMP]:30393037A035A0338631687474703A2F2F63726C332E64696769636572742E636F6D2F4469676943657274476C6F62616C526F6F7443412E63726C</span><br><span class="line">844:d&#x3D;4  hl&#x3D;2 l&#x3D;  76 cons:     SEQUENCE</span><br><span class="line">846:d&#x3D;5  hl&#x3D;2 l&#x3D;   3 prim:      OBJECT            :X509v3 Certificate Policies</span><br><span class="line">851:d&#x3D;5  hl&#x3D;2 l&#x3D;  69 prim:      OCTET STRING      [HEX DUMP]:3043303706096086480186FD6C0102302A302806082B06010505070201161C68747470733A2F2F7777772E64696769636572742E636F6D2F4350533008060667810C010201</span><br><span class="line">922:d&#x3D;1  hl&#x3D;2 l&#x3D;  13 cons:  SEQUENCE</span><br><span class="line">924:d&#x3D;2  hl&#x3D;2 l&#x3D;   9 prim:   OBJECT            :sha256WithRSAEncryption</span><br><span class="line">935:d&#x3D;2  hl&#x3D;2 l&#x3D;   0 prim:   NULL</span><br><span class="line">937:d&#x3D;1  hl&#x3D;4 l&#x3D; 257 prim:  BIT STRING</span><br></pre></td></tr></table></figure>

<p>找到 <code>rsaEncryption</code>，它在 d=4 的层级，公钥所在位置为下方的 d=3 层级的 BIT STRING：</p>
<p><code>308:d=3  hl=4 l= 271</code></p>
<p>根据 <a href="https://datatracker.ietf.org/doc/html/rfc3279#section-2.3.1" target="_blank" rel="noopener">rfc 3279</a> 的定义，RSA PublickKey 由系数 (modulus) 和指数 (exponent) 两部分组成。因此 271 字节里面的两部分要分开获取。这两部分也是使用 DER 格式编码的，可以直接使用工具解析：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openssl asn1parse -inform DER -in EncryptionEverywhereDVTLSCA-G1.crt --strparse 308 -noout -out EncryptionEverywhereDVTLSCA-G1.rsa</span><br><span class="line"></span><br><span class="line">openssl asn1parse -i -inform DER -in EncryptionEverywhereDVTLSCA-G1.rsa</span><br></pre></td></tr></table></figure>

<p>得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  0:d&#x3D;0  hl&#x3D;4 l&#x3D; 266 cons: SEQUENCE</span><br><span class="line">  4:d&#x3D;1  hl&#x3D;4 l&#x3D; 257 prim:  INTEGER           :B3DE3FAC2469BE35772421EA629CA07AADDE3448C56E4C0EF7FD43288E47B55F1702BAE7A7ACD1416221BEF837DA519EDCC5D54818CC31AEDE9A5954C76895BC619BA7564BD38AFE515E84A353D0E608F5AAA4E85F94EDC03A8F1482FA20C13D7C1D178AECDCA472A776909FAA63A69D72AFB201E98E33BFBD847BF3E567FEAB2BA2270BA5A92B49CF54E611EE7F620EE3DED44E08C543011FF4F7DFEDE1CAE1F776F7E089650E5248DDA4C6F2C57F973657B9B84222C81B22E08BDB7130A1F2BBA27C2222E660D7919AE7313F27C1F60257ABFA90375791B80644B2AC478A6E71B26D6CAA889141B1B99236B7BA5F7B02917399D679CBC30597F7FA9D4CA40F</span><br><span class="line">265:d&#x3D;1  hl&#x3D;2 l&#x3D;   3 prim:  INTEGER           :010001</span><br></pre></td></tr></table></figure>

<p>其中第一个 INTEGER 是 modulus，第二个 INTEGER 是 exponent。由于可以直接复制，不再使用 xxd 命令。</p>
<p>验证这个信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -inform DER -in EncryptionEverywhereDVTLSCA-G1.crt -noout -text</span><br></pre></td></tr></table></figure>

<p>在 <code>Subject Public Key Info</code> 一节里可以看到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">00:b3:de:3f:ac:24:69:be:35:77:24:21:ea:62:9c:</span><br><span class="line">a0:7a:ad:de:34:48:c5:6e:4c:0e:f7:fd:43:28:8e:</span><br><span class="line">47:b5:5f:17:02:ba:e7:a7:ac:d1:41:62:21:be:f8:</span><br><span class="line">37:da:51:9e:dc:c5:d5:48:18:cc:31:ae:de:9a:59:</span><br><span class="line">54:c7:68:95:bc:61:9b:a7:56:4b:d3:8a:fe:51:5e:</span><br><span class="line">84:a3:53:d0:e6:08:f5:aa:a4:e8:5f:94:ed:c0:3a:</span><br><span class="line">8f:14:82:fa:20:c1:3d:7c:1d:17:8a:ec:dc:a4:72:</span><br><span class="line">a7:76:90:9f:aa:63:a6:9d:72:af:b2:01:e9:8e:33:</span><br><span class="line">bf:bd:84:7b:f3:e5:67:fe:ab:2b:a2:27:0b:a5:a9:</span><br><span class="line">2b:49:cf:54:e6:11:ee:7f:62:0e:e3:de:d4:4e:08:</span><br><span class="line">c5:43:01:1f:f4:f7:df:ed:e1:ca:e1:f7:76:f7:e0:</span><br><span class="line">89:65:0e:52:48:dd:a4:c6:f2:c5:7f:97:36:57:b9:</span><br><span class="line">b8:42:22:c8:1b:22:e0:8b:db:71:30:a1:f2:bb:a2:</span><br><span class="line">7c:22:22:e6:60:d7:91:9a:e7:31:3f:27:c1:f6:02:</span><br><span class="line">57:ab:fa:90:37:57:91:b8:06:44:b2:ac:47:8a:6e:</span><br><span class="line">71:b2:6d:6c:aa:88:91:41:b1:b9:92:36:b7:ba:5f:</span><br><span class="line">7b:02:91:73:99:d6:79:cb:c3:05:97:f7:fa:9d:4c:</span><br><span class="line">a4:0f</span><br></pre></td></tr></table></figure>

<p>以及： Exponent: 65537 (0x10001)。</p>
<p>与上述获取的一致。</p>
<h4 id="使用-CA-公钥解密"><a href="#使用-CA-公钥解密" class="headerlink" title="使用 CA 公钥解密"></a>使用 CA 公钥解密</h4><p>已知的内容：</p>
<ul>
<li><p>签名值 sig ：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">49aa4a0ff0052f53f27fd1681b11f6247a75b6da247b589a8cec50a7abd3e1ddc9cbbd09a221e529466bdacb34d3bf9555fa4714731b33326cf341d2cd5ac6b5996d22a682dcd8a97ea2245b3318fddc423d17d16318cd925c6d5873a40f16d9b0a6393c18e66d57be6c30688d10faf55b833479cb2735835210c7c6869bc2c33edf7acb531e1e96d3a47796d0f2fe3c3784d3f35e0e7824094bb4b388e8d95861b864a71c50e3b6da9512be585a14196dc7ec2e80f74a06fead44b7340f1a6c3fa1451bd64eadf8ec71d866dee43e44cfcaae3ecc9804e12037400e6548ce77c080d2b09840aa7297aa862679f228a7fac1187a68355946d49a5ae7389d6a38</span><br></pre></td></tr></table></figure>
</li>
<li><p>CA 公钥系数 modulus：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B3DE3FAC2469BE35772421EA629CA07AADDE3448C56E4C0EF7FD43288E47B55F1702BAE7A7ACD1416221BEF837DA519EDCC5D54818CC31AEDE9A5954C76895BC619BA7564BD38AFE515E84A353D0E608F5AAA4E85F94EDC03A8F1482FA20C13D7C1D178AECDCA472A776909FAA63A69D72AFB201E98E33BFBD847BF3E567FEAB2BA2270BA5A92B49CF54E611EE7F620EE3DED44E08C543011FF4F7DFEDE1CAE1F776F7E089650E5248DDA4C6F2C57F973657B9B84222C81B22E08BDB7130A1F2BBA27C2222E660D7919AE7313F27C1F60257ABFA90375791B80644B2AC478A6E71B26D6CAA889141B1B99236B7BA5F7B02917399D679CBC30597F7FA9D4CA40F</span><br></pre></td></tr></table></figure>
</li>
<li><p>CA 公钥指数 exponent：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x10001</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>根据公式 decrypted_value = (modulus^exponent)%sig，使用 python 计算：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">modulus=<span class="number">0xB3DE3FAC2469BE35772421EA629CA07AADDE3448C56E4C0EF7FD43288E47B55F1702BAE7A7ACD1416221BEF837DA519EDCC5D54818CC31AEDE9A5954C76895BC619BA7564BD38AFE515E84A353D0E608F5AAA4E85F94EDC03A8F1482FA20C13D7C1D178AECDCA472A776909FAA63A69D72AFB201E98E33BFBD847BF3E567FEAB2BA2270BA5A92B49CF54E611EE7F620EE3DED44E08C543011FF4F7DFEDE1CAE1F776F7E089650E5248DDA4C6F2C57F973657B9B84222C81B22E08BDB7130A1F2BBA27C2222E660D7919AE7313F27C1F60257ABFA90375791B80644B2AC478A6E71B26D6CAA889141B1B99236B7BA5F7B02917399D679CBC30597F7FA9D4CA40F</span></span><br><span class="line"></span><br><span class="line">sig=<span class="number">0x49aa4a0ff0052f53f27fd1681b11f6247a75b6da247b589a8cec50a7abd3e1ddc9cbbd09a221e529466bdacb34d3bf9555fa4714731b33326cf341d2cd5ac6b5996d22a682dcd8a97ea2245b3318fddc423d17d16318cd925c6d5873a40f16d9b0a6393c18e66d57be6c30688d10faf55b833479cb2735835210c7c6869bc2c33edf7acb531e1e96d3a47796d0f2fe3c3784d3f35e0e7824094bb4b388e8d95861b864a71c50e3b6da9512be585a14196dc7ec2e80f74a06fead44b7340f1a6c3fa1451bd64eadf8ec71d866dee43e44cfcaae3ecc9804e12037400e6548ce77c080d2b09840aa7297aa862679f228a7fac1187a68355946d49a5ae7389d6a38</span></span><br><span class="line"></span><br><span class="line">exponent=<span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">"%x"</span> % pow(sig, exponent, modulus))</span><br></pre></td></tr></table></figure>

<p>得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff003031300d060960864801650304020105000420bca9d80920262764ca037b51a1f7bfd8a240c8059c7564dafdaf12ded366d6f5</span><br></pre></td></tr></table></figure>

<p>开头的 <code>1fff...</code> 是 RSA 算法的填充字节，接下来的 <code>3031300D060960864801650304020105000420</code> 是 sha256 的填充字节。剩下的 <code>bca9d80920262764ca037b51a1f7bfd8a240c8059c7564dafdaf12ded366d6f5</code> 是证书 hash 值。</p>
<p>我们将该值与前面手动计算的 TBS 证书 hash 值做对比，得到完全一致。</p>
<p>至此，验证完毕。</p>
<h3 id="证书链"><a href="#证书链" class="headerlink" title="证书链"></a>证书链</h3><p>上面只验证了第一步。从浏览器中可以看出，上述 CA 证书不是根证书，还需要验证 CA 证书的可信。步骤与上述差不多，只是根证书是安装在设备的操作系统上或者浏览器上。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[1]: https:&#x2F;&#x2F;blog.yuantops.com&#x2F;tech&#x2F;validate_a_digital_certificate_step_by_step&#x2F; (手工验证一张数字证书的有效性)</span><br><span class="line">[2]: https:&#x2F;&#x2F;yongbingchen.github.io&#x2F;blog&#x2F;2015&#x2F;04&#x2F;09&#x2F;verify-the-signature-of-a-x-dot-509-certificate&#x2F; (https:&#x2F;&#x2F;yongbingchen.github.io&#x2F;blog&#x2F;2015&#x2F;04&#x2F;09&#x2F;verify-the-signature-of-a-x-dot-509-certificate&#x2F;)</span><br><span class="line">[3]: https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;rfc3279 (RFC 3279) </span><br><span class="line">[4]: https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;rfc2313 (RFC 2313)</span><br><span class="line">[5]: https:&#x2F;&#x2F;datatracker.ietf.org&#x2F;doc&#x2F;html&#x2F;rfc3280 (RFC 3280)</span><br><span class="line">[6]: https:&#x2F;&#x2F;docs.microsoft.com&#x2F;en-us&#x2F;windows&#x2F;win32&#x2F;seccertenroll&#x2F;about-encoded-length-and-value-bytes (Encoded Length and Value Bytes)</span><br><span class="line">[7]: https:&#x2F;&#x2F;linux.die.net&#x2F;man&#x2F;1&#x2F;asn1parse (asn1parse(1) - Linux man page)</span><br><span class="line">[8]: https:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;2614764&#x2F;how-to-create-a-hex-dump-of-file-containing-only-the-hex-characters-without-spac (How to create a hex dump of file containing only the hex characters without spaces in bash?)</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/HTTPS/" rel="tag"># HTTPS</a>
              <a href="/tags/TLS/" rel="tag"># TLS</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/05/08/2022-life-part1/" rel="prev" title="风暴过去了，但有新的挑战 —— 2022 的三分之一">
      <i class="fa fa-chevron-left"></i> 风暴过去了，但有新的挑战 —— 2022 的三分之一
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/05/11/tree-rotation/" rel="next" title="因为一句话，秒懂二叉树旋转">
      因为一句话，秒懂二叉树旋转 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#证书验证"><span class="nav-number">1.</span> <span class="nav-text">证书验证</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#证书结构"><span class="nav-number">1.1.</span> <span class="nav-text">证书结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#证书验证-1"><span class="nav-number">1.2.</span> <span class="nav-text">证书验证</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#证书下载"><span class="nav-number">1.2.1.</span> <span class="nav-text">证书下载</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#获取证书主体（待签名证书）"><span class="nav-number">1.2.2.</span> <span class="nav-text">获取证书主体（待签名证书）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#计算证书-hash-值"><span class="nav-number">1.2.3.</span> <span class="nav-text">计算证书 hash 值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#签名值"><span class="nav-number">1.2.4.</span> <span class="nav-text">签名值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CA-证书公钥"><span class="nav-number">1.2.5.</span> <span class="nav-text">CA 证书公钥</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用-CA-公钥解密"><span class="nav-number">1.2.6.</span> <span class="nav-text">使用 CA 公钥解密</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#证书链"><span class="nav-number">1.3.</span> <span class="nav-text">证书链</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考"><span class="nav-number">2.</span> <span class="nav-text">参考</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Schaepher"
      src="/images/theme/avatar.png">
  <p class="site-author-name" itemprop="name">Schaepher</p>
  <div class="site-description" itemprop="description">深透理解，熟练运用。<br>似懂非懂，其实不懂。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">120</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">128</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder"><a rel="license noopener" href="http://creativecommons.org/licenses/by/2.5/cn/" target="_blank"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by/2.5/cn/88x31.png" /></a><br />本文采用<a rel="license noopener" href="http://creativecommons.org/licenses/by/2.5/cn/" target="_blank">知识共享署名 2.5 中国大陆许可协议</a>进行许可。欢迎转载，演绎或用于商业目的，但是必须保留本文的署名 <a href="https://www.cnblogs.com/schaepher" target="_blank" rel="noopener">schaepher</a>（包含链接）。如您有任何疑问或者授权方面的协商，请<a target="_blank" href="https://msg.cnblogs.com/send/schaepher">给我留言</a>。</p></span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.7.2
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '550f95e66af72a97323b',
      clientSecret: '8a1b43baf425cb852f7322dd40596d9a73c8c6c8',
      repo        : 'schaepher.github.io',
      owner       : 'schaepher',
      admin       : ['schaepher'],
      id          : 'da2ed5d9a00845d684467f07a99c3273',
        language: '',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
