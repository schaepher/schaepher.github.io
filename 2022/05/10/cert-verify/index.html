<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>手动验证 TLS 证书 - Schaepher's Blog</title><meta name=Description content="深透理解，熟练运用；似懂非懂，其实不懂。"><meta property="og:url" content="https://schaepher.github.io/2022/05/10/cert-verify/">
<meta property="og:site_name" content="Schaepher's Blog"><meta property="og:title" content="手动验证 TLS 证书"><meta property="og:description" content="证书验证 证书结构 我们现在使用的 TLS 证书的标准是 X.509，版本号为 V3。版本号可从证书的 Version 字段看到。
根据 RFC 3280 定义的证书结构，证书由三个部分组成：
证书主体（TBSCertificate，To Be Signed Certificate，待签名证书） 签名算法 签名值 证书主体包括版本、序列号、公钥等内容。签名值是对证书主体使用签名算法计算并经过证书签名机构私钥加密后的值。"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-10T12:30:00+00:00"><meta property="article:modified_time" content="2022-05-10T12:30:00+00:00"><meta property="article:tag" content="HTTPS"><meta property="article:tag" content="TLS"><meta property="og:image" content="https://schaepher.github.io/logo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://schaepher.github.io/logo.png"><meta name=twitter:title content="手动验证 TLS 证书"><meta name=twitter:description content="证书验证 证书结构 我们现在使用的 TLS 证书的标准是 X.509，版本号为 V3。版本号可从证书的 Version 字段看到。
根据 RFC 3280 定义的证书结构，证书由三个部分组成：
证书主体（TBSCertificate，To Be Signed Certificate，待签名证书） 签名算法 签名值 证书主体包括版本、序列号、公钥等内容。签名值是对证书主体使用签名算法计算并经过证书签名机构私钥加密后的值。"><meta name=application-name content="Schaepher's Blog"><meta name=apple-mobile-web-app-title content="Schaepher's Blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://schaepher.github.io/2022/05/10/cert-verify/><link rel=prev href=https://schaepher.github.io/2022/05/08/2022-life-part1/><link rel=next href=https://schaepher.github.io/2022/05/11/tree-rotation/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/css/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"手动验证 TLS 证书","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/schaepher.github.io\/2022\/05\/10\/cert-verify\/"},"genre":"posts","keywords":"HTTPS, TLS","wordcount":3080,"url":"https:\/\/schaepher.github.io\/2022\/05\/10\/cert-verify\/","datePublished":"2022-05-10T12:30:00+00:00","dateModified":"2022-05-10T12:30:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"xxxx"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Schaepher's Blog"></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/>主页 </a><a class=menu-item href=/posts/ title=文章按年份分类>文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Schaepher's Blog"></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/ title>主页</a><a class=menu-item href=/posts/ title=文章按年份分类>文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">手动验证 TLS 证书</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>xxxx</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-05-10>2022-05-10</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;约 3080 字&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;预计阅读 7 分钟&nbsp;</div></div><div class="details toc" id=toc-static data-kept=true><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#证书验证>证书验证</a><ul><li><a href=#证书结构>证书结构</a></li><li><a href=#证书验证-1>证书验证</a><ul><li><a href=#证书下载>证书下载</a></li><li><a href=#der-证书解析>DER 证书解析</a></li><li><a href=#获取证书主体待签名证书>获取证书主体（待签名证书）</a></li><li><a href=#计算证书-hash-值>计算证书 hash 值</a></li><li><a href=#签名值>签名值</a></li><li><a href=#ca-证书公钥>CA 证书公钥</a></li><li><a href=#使用-ca-公钥解密>使用 CA 公钥解密</a></li></ul></li><li><a href=#证书链>证书链</a></li></ul></li><li><a href=#参考>参考</a></li></ul></nav></div></div><div class=content id=content><h2 id=证书验证>证书验证</h2><h3 id=证书结构>证书结构</h3><p>我们现在使用的 TLS 证书的标准是 X.509，版本号为 V3。版本号可从证书的 Version 字段看到。</p><p>根据 <a href="https://datatracker.ietf.org/doc/html/rfc3280.html?msclkid=a0a5d923cf8211ec99debd4d1b18e2b5#section-4.1" target=_blank rel="noopener noreffer">RFC 3280</a> 定义的证书结构，证书由三个部分组成：</p><ol><li>证书主体（TBSCertificate，To Be Signed Certificate，待签名证书）</li><li>签名算法</li><li>签名值</li></ol><p>证书主体包括版本、序列号、公钥等内容。签名值是对证书主体使用签名算法计算并经过证书签名机构私钥加密后的值。</p><p>证书的数据组织格式为 ASN.1 DER 格式（distinguished encoding rules）。这是一种 TLV 编码，其中的每个元素都包含 Tag、Length、Value。通常我们获得的证书是经由 Base64 编码后的 PEM 文件，为了节省不必要的麻烦，后续内容会提前将证书转回 DER 格式。</p><p>PEM 文件的格式是这样的：</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>-----BEGIN CERTIFICATE-----
</span></span><span class=line><span class=cl>这里是 Base64 编码后的内容
</span></span><span class=line><span class=cl>-----END CERTIFICATE-----</span></span></code></pre></div></div><h3 id=证书验证-1>证书验证</h3><p>为了验证证书，我们需要获取以下内容：</p><ol><li>证书主体。用于通过签名算法得到其 hash 值</li><li>证书签名值。</li><li>CA 的公钥。用于解密签名，得到证书主体的 hash 值</li></ol><p>如果 1 和 3 的 hash 值相等，则说明此次验证通过。</p><p>我们以博客园的证书为例。</p><h4 id=证书下载>证书下载</h4><ol><li>下载博客园证书<div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-bash"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> -n <span class=p>|</span> openssl s_client -connect www.cnblogs.com:443 <span class=p>|</span> openssl x509 -outform DER &gt; www.cnblogs.com.crt</span></span></code></pre></div></div>证书原文是用 Base64 编码后的 PEM 格式文件，这里将其直接转换为 DER 格式。</li><li>查看博客园的 CA 证书地址<div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-bash"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl x509 -inform DER -in www.cnblogs.com.crt -noout -text  <span class=p>|</span> grep <span class=s2>&#34;CA Issuers&#34;</span></span></span></code></pre></div></div>得到：<div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-bash"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>CA Issuers - URI:http://cacerts.digicert.com/EncryptionEverywhereDVTLSCA-G1.crt</span></span></code></pre></div></div></li><li>下载 CA 证书<div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-bash"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -O http://cacerts.digicert.com/EncryptionEverywhereDVTLSCA-G1.crt</span></span></code></pre></div></div>这个证书已经是 DER 格式，无需转换。</li></ol><p>现在，我们得到了：</p><ul><li>博客园证书</li><li>给博客园证书签名的 CA 的证书</li></ul><h4 id=der-证书解析>DER 证书解析</h4><p>在开始验证之前，再次了解证书的格式，便于理解后续的获取操作。</p><p>证书由证书主体、签名算法和签名值三个部分组成。DER 格式每个元素以 SEQUENCE 作为开头。由于完整的证书是一个 SEQUENCE，因此证书最外层有个 SEQUENCE。里面三个部分都各自有一个 SEQUENCE。</p><p>执行命令查看内容：</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-bash"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl asn1parse -i -inform DER -in www.cnblogs.com.crt</span></span></code></pre></div></div><p>解析的格式为：开头数字是偏移量，d 表示深度（depth），d 相同的表示是同一个层级。hl 表示头部长度（header length），l 表示不包含头部的数据长度（lenght）。</p><div class="code-block code-line-numbers" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>    0:d=0  hl=4 l=1534 cons: SEQUENCE
</span></span><span class=line><span class=cl>    4:d=1  hl=4 l=1254 cons:  SEQUENCE
</span></span><span class=line><span class=cl>    8:d=2  hl=2 l=   3 cons:   cont [ 0 ]
</span></span><span class=line><span class=cl>   10:d=3  hl=2 l=   1 prim:    INTEGER           :02
</span></span><span class=line><span class=cl>   13:d=2  hl=2 l=  16 prim:   INTEGER           :03E3AC5347CD4A3862C2855A71A6F94F
</span></span><span class=line><span class=cl>   31:d=2  hl=2 l=  13 cons:   SEQUENCE
</span></span><span class=line><span class=cl>   33:d=3  hl=2 l=   9 prim:    OBJECT            :sha256WithRSAEncryption
</span></span><span class=line><span class=cl>   44:d=3  hl=2 l=   0 prim:    NULL
</span></span><span class=line><span class=cl>   46:d=2  hl=2 l= 110 cons:   SEQUENCE
</span></span><span class=line><span class=cl>   48:d=3  hl=2 l=  11 cons:    SET
</span></span><span class=line><span class=cl>   50:d=4  hl=2 l=   9 cons:     SEQUENCE
</span></span><span class=line><span class=cl>   52:d=5  hl=2 l=   3 prim:      OBJECT            :countryName
</span></span><span class=line><span class=cl>   57:d=5  hl=2 l=   2 prim:      PRINTABLESTRING   :US
</span></span><span class=line><span class=cl>   61:d=3  hl=2 l=  21 cons:    SET
</span></span><span class=line><span class=cl>   63:d=4  hl=2 l=  19 cons:     SEQUENCE
</span></span><span class=line><span class=cl>   65:d=5  hl=2 l=   3 prim:      OBJECT            :organizationName
</span></span><span class=line><span class=cl>   70:d=5  hl=2 l=  12 prim:      PRINTABLESTRING   :DigiCert Inc
</span></span><span class=line><span class=cl>   84:d=3  hl=2 l=  25 cons:    SET
</span></span><span class=line><span class=cl>   86:d=4  hl=2 l=  23 cons:     SEQUENCE
</span></span><span class=line><span class=cl>   88:d=5  hl=2 l=   3 prim:      OBJECT            :organizationalUnitName
</span></span><span class=line><span class=cl>   93:d=5  hl=2 l=  16 prim:      PRINTABLESTRING   :www.digicert.com
</span></span><span class=line><span class=cl>  111:d=3  hl=2 l=  45 cons:    SET
</span></span><span class=line><span class=cl>  113:d=4  hl=2 l=  43 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  115:d=5  hl=2 l=   3 prim:      OBJECT            :commonName
</span></span><span class=line><span class=cl>  120:d=5  hl=2 l=  36 prim:      PRINTABLESTRING   :Encryption Everywhere DV TLS CA - G1
</span></span><span class=line><span class=cl>  158:d=2  hl=2 l=  30 cons:   SEQUENCE
</span></span><span class=line><span class=cl>  160:d=3  hl=2 l=  13 prim:    UTCTIME           :220228000000Z
</span></span><span class=line><span class=cl>  175:d=3  hl=2 l=  13 prim:    UTCTIME           :230301235959Z
</span></span><span class=line><span class=cl>  190:d=2  hl=2 l=  24 cons:   SEQUENCE
</span></span><span class=line><span class=cl>  192:d=3  hl=2 l=  22 cons:    SET
</span></span><span class=line><span class=cl>  194:d=4  hl=2 l=  20 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  196:d=5  hl=2 l=   3 prim:      OBJECT            :commonName
</span></span><span class=line><span class=cl>  201:d=5  hl=2 l=  13 prim:      UTF8STRING        :*.cnblogs.com
</span></span><span class=line><span class=cl>  216:d=2  hl=4 l= 290 cons:   SEQUENCE
</span></span><span class=line><span class=cl>  220:d=3  hl=2 l=  13 cons:    SEQUENCE
</span></span><span class=line><span class=cl>  222:d=4  hl=2 l=   9 prim:     OBJECT            :rsaEncryption
</span></span><span class=line><span class=cl>  233:d=4  hl=2 l=   0 prim:     NULL
</span></span><span class=line><span class=cl>  235:d=3  hl=4 l= 271 prim:    BIT STRING
</span></span><span class=line><span class=cl>  510:d=2  hl=4 l= 748 cons:   cont [ 3 ]
</span></span><span class=line><span class=cl>  514:d=3  hl=4 l= 744 cons:    SEQUENCE
</span></span><span class=line><span class=cl>  518:d=4  hl=2 l=  31 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  520:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Authority Key Identifier
</span></span><span class=line><span class=cl>  525:d=5  hl=2 l=  24 prim:      OCTET STRING      [HEX DUMP]:3016801455744FB2724FF560BA50D1D7E6515C9A01871AD7
</span></span><span class=line><span class=cl>  551:d=4  hl=2 l=  29 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  553:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Subject Key Identifier
</span></span><span class=line><span class=cl>  558:d=5  hl=2 l=  22 prim:      OCTET STRING      [HEX DUMP]:04149DE559358AA4C25E1A52193A745F007F101B1C17
</span></span><span class=line><span class=cl>  582:d=4  hl=2 l=  37 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  584:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Subject Alternative Name
</span></span><span class=line><span class=cl>  589:d=5  hl=2 l=  30 prim:      OCTET STRING      [HEX DUMP]:301C820D2A2E636E626C6F67732E636F6D820B636E626C6F67732E636F6D
</span></span><span class=line><span class=cl>  621:d=4  hl=2 l=  14 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  623:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Key Usage
</span></span><span class=line><span class=cl>  628:d=5  hl=2 l=   1 prim:      BOOLEAN           :255
</span></span><span class=line><span class=cl>  631:d=5  hl=2 l=   4 prim:      OCTET STRING      [HEX DUMP]:030205A0
</span></span><span class=line><span class=cl>  637:d=4  hl=2 l=  29 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  639:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Extended Key Usage
</span></span><span class=line><span class=cl>  644:d=5  hl=2 l=  22 prim:      OCTET STRING      [HEX DUMP]:301406082B0601050507030106082B06010505070302
</span></span><span class=line><span class=cl>  668:d=4  hl=2 l=  62 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  670:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Certificate Policies
</span></span><span class=line><span class=cl>  675:d=5  hl=2 l=  55 prim:      OCTET STRING      [HEX DUMP]:30353033060667810C0102013029302706082B06010505070201161B687474703A2F2F7777772E64696769636572742E636F6D2F435053
</span></span><span class=line><span class=cl>  732:d=4  hl=3 l= 128 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  735:d=5  hl=2 l=   8 prim:      OBJECT            :Authority Information Access
</span></span><span class=line><span class=cl>  745:d=5  hl=2 l= 116 prim:      OCTET STRING      [HEX DUMP]:3072302406082B060105050730018618687474703A2F2F6F6373702E64696769636572742E636F6D304A06082B06010505073002863E687474703A2F2F636163657274732E64696769636572742E636F6D2F456E6372797074696F6E457665727977686572654456544C5343412D47312E637274
</span></span><span class=line><span class=cl>  863:d=4  hl=2 l=   9 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  865:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Basic Constraints
</span></span><span class=line><span class=cl>  870:d=5  hl=2 l=   2 prim:      OCTET STRING      [HEX DUMP]:3000
</span></span><span class=line><span class=cl>  874:d=4  hl=4 l= 384 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  878:d=5  hl=2 l=  10 prim:      OBJECT            :CT Precertificate SCTs
</span></span><span class=line><span class=cl>  890:d=5  hl=4 l= 368 prim:      OCTET STRING      [HEX DUMP]:0482016C016A007700E83ED0DA3EF5063532E75728BC896BC903D3CBD1116BECEB69E1777D6D06BD6E0000017F3E1A44D10000040300483046022100D8162F949F2820F1C3CCF73AD2826F04CDD3EA09C16BAD2441AE07C69D149DE1022100AC4C3B8EB60C5613C32B85C5303ACC67F62888DFB7925861088B21B550E16E9600760035CF191BBFB16C57BF0FAD4C6D42CBBBB627202651EA3FE12AEFA803C33BD64C0000017F3E1A45110000040300473045022100A4D6915799132F3997B16F009F7011520A3BB30A040DAE42B73D905975DBADBD02206165D6DA0CB72F87B8FA7F309806919893FA962126F6D94512DB700CDF019B84007700B3737707E18450F86386D605A9DC11094A792DB1670C0B87DCF0030E7936A59A0000017F3E1A45370000040300483046022100B31A83931E8A4D8BD4FD2F28E8C42D3B1083D79E9F5E7F9F8B8D1C4D33DE8C65022100E6D91B7986CA850272265DEDBD4C40180BB73B69447304F423BDA19B29F4ADE3
</span></span><span class=line><span class=cl> 1262:d=1  hl=2 l=  13 cons:  SEQUENCE
</span></span><span class=line><span class=cl> 1264:d=2  hl=2 l=   9 prim:   OBJECT            :sha256WithRSAEncryption
</span></span><span class=line><span class=cl> 1275:d=2  hl=2 l=   0 prim:   NULL
</span></span><span class=line><span class=cl> 1277:d=1  hl=4 l= 257 prim:  BIT STRING</span></span></code></pre></div></div><p>例如第一行：<br><code>0:d=0 hl=4 l=1534 cons: SEQUENCE</code></p><p>开头 0 表示偏移量为 0，就是整个文件的开头。d=0 表示最顶层，为整个证书的对象。头部长度为 4 字节，数据字段（也就是三个部分）总共 1534 字节，加起来整个文件共 1538 字节。</p><p>再看最后一行，</p><p><code>1277:d=1 hl=4 l= 257 prim: BIT STRING</code></p><p>开头 1277 表示偏移量，d=1 表示顶层的下一层，而这个位置在最后一部分，那么就代表是签名值。头部长度为 4 字节，数据长度为 257 字节，加起来共 261 字节。加上偏移量 1277 + 261 = 1538 字节，与第一行的计算结果吻合。</p><h4 id=获取证书主体待签名证书>获取证书主体（待签名证书）</h4><p>根据定义，第一个部分就是待签名证书。因此从第一个 d=1 的地方开始，即文件的第二行。</p><p><code>4:d=1 hl=4 l=1254 cons: SEQUENCE</code></p><p>表示偏移量为 4，头部 4 字节，数据 1254 字节。hash 的时候会连头部都算上，所以总共获取 1258 字节。</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-bash"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>dd <span class=k>if</span><span class=o>=</span>www.cnblogs.com.crt <span class=nv>of</span><span class=o>=</span>www.cnblogs.com.tbs <span class=nv>bs</span><span class=o>=</span><span class=m>1</span> <span class=nv>skip</span><span class=o>=</span><span class=m>4</span> <span class=nv>count</span><span class=o>=</span><span class=m>1258</span></span></span></code></pre></div></div><p>这里 bs=1 表示每次读取一个字节，count 表示读取 1258 次，两者组合起来就是读取 1258 个字节。</p><h4 id=计算证书-hash-值>计算证书 hash 值</h4><p>获取签名和加密算法：</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>openssl x509 -inform DER -in www.cnblogs.com.crt -noout -text | grep &#39;Signature Algorithm&#39; | tail -n 1</span></span></code></pre></div></div><p>sha256WithRSAEncryption 表示使用 sha256 hash，并使用 RSA 加密。</p><p>计算：</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sha256sum www.cnblogs.com.tbs</span></span></code></pre></div></div><p>得到结果：</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>bca9d80920262764ca037b51a1f7bfd8a240c8059c7564dafdaf12ded366d6f5  www.cnblogs.com.tbs</span></span></code></pre></div></div><h4 id=签名值>签名值</h4><p>从 ASN.1 解析后的数据，可以知道签名值的偏移量是 1277。</p><p>截取签名值：</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-bash"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl asn1parse  -inform DER -in www.cnblogs.com.crt --strparse <span class=m>1277</span> -noout -out www.cnblogs.com.sig</span></span></code></pre></div></div><p>验证这个数据：</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-bash"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>xxd -p www.cnblogs.com.sig  <span class=p>|</span> tr -d <span class=s1>&#39;\n&#39;</span></span></span></code></pre></div></div><p>得到：</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>49aa4a0ff0052f53f27fd1681b11f6247a75b6da247b589a8cec50a7abd3e1ddc9cbbd09a221e529466bdacb34d3bf9555fa4714731b33326cf341d2cd5ac6b5996d22a682dcd8a97ea2245b3318fddc423d17d16318cd925c6d5873a40f16d9b0a6393c18e66d57be6c30688d10faf55b833479cb2735835210c7c6869bc2c33edf7acb531e1e96d3a47796d0f2fe3c3784d3f35e0e7824094bb4b388e8d95861b864a71c50e3b6da9512be585a14196dc7ec2e80f74a06fead44b7340f1a6c3fa1451bd64eadf8ec71d866dee43e44cfcaae3ecc9804e12037400e6548ce77c080d2b09840aa7297aa862679f228a7fac1187a68355946d49a5ae7389d6a38</span></span></code></pre></div></div><p>查看得到的结果是否与以下命令的最后一部分一致：</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-bash"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl x509 -inform DER -in www.cnblogs.com.crt -noout -text</span></span></code></pre></div></div><div class="code-block code-line-numbers" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>49:aa:4a:0f:f0:05:2f:53:f2:7f:d1:68:1b:11:f6:24:7a:75:
</span></span><span class=line><span class=cl>b6:da:24:7b:58:9a:8c:ec:50:a7:ab:d3:e1:dd:c9:cb:bd:09:
</span></span><span class=line><span class=cl>a2:21:e5:29:46:6b:da:cb:34:d3:bf:95:55:fa:47:14:73:1b:
</span></span><span class=line><span class=cl>33:32:6c:f3:41:d2:cd:5a:c6:b5:99:6d:22:a6:82:dc:d8:a9:
</span></span><span class=line><span class=cl>7e:a2:24:5b:33:18:fd:dc:42:3d:17:d1:63:18:cd:92:5c:6d:
</span></span><span class=line><span class=cl>58:73:a4:0f:16:d9:b0:a6:39:3c:18:e6:6d:57:be:6c:30:68:
</span></span><span class=line><span class=cl>8d:10:fa:f5:5b:83:34:79:cb:27:35:83:52:10:c7:c6:86:9b:
</span></span><span class=line><span class=cl>c2:c3:3e:df:7a:cb:53:1e:1e:96:d3:a4:77:96:d0:f2:fe:3c:
</span></span><span class=line><span class=cl>37:84:d3:f3:5e:0e:78:24:09:4b:b4:b3:88:e8:d9:58:61:b8:
</span></span><span class=line><span class=cl>64:a7:1c:50:e3:b6:da:95:12:be:58:5a:14:19:6d:c7:ec:2e:
</span></span><span class=line><span class=cl>80:f7:4a:06:fe:ad:44:b7:34:0f:1a:6c:3f:a1:45:1b:d6:4e:
</span></span><span class=line><span class=cl>ad:f8:ec:71:d8:66:de:e4:3e:44:cf:ca:ae:3e:cc:98:04:e1:
</span></span><span class=line><span class=cl>20:37:40:0e:65:48:ce:77:c0:80:d2:b0:98:40:aa:72:97:aa:
</span></span><span class=line><span class=cl>86:26:79:f2:28:a7:fa:c1:18:7a:68:35:59:46:d4:9a:5a:e7:
</span></span><span class=line><span class=cl>38:9d:6a:38</span></span></code></pre></div></div><p>这部分直接从完整的 text 中复制然后手动编辑也可以。</p><h4 id=ca-证书公钥>CA 证书公钥</h4><p>解析并查看位置：</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-bash"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>openssl asn1parse -i -inform DER -in EncryptionEverywhereDVTLSCA-G1.crt</span></span></code></pre></div></div><div class="code-block code-line-numbers" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>    0:d=0  hl=4 l=1194 cons: SEQUENCE
</span></span><span class=line><span class=cl>    4:d=1  hl=4 l= 914 cons:  SEQUENCE
</span></span><span class=line><span class=cl>    8:d=2  hl=2 l=   3 cons:   cont [ 0 ]
</span></span><span class=line><span class=cl>   10:d=3  hl=2 l=   1 prim:    INTEGER           :02
</span></span><span class=line><span class=cl>   13:d=2  hl=2 l=  16 prim:   INTEGER           :0279AC458BC1B245ABF98053CD2C9BB1
</span></span><span class=line><span class=cl>   31:d=2  hl=2 l=  13 cons:   SEQUENCE
</span></span><span class=line><span class=cl>   33:d=3  hl=2 l=   9 prim:    OBJECT            :sha256WithRSAEncryption
</span></span><span class=line><span class=cl>   44:d=3  hl=2 l=   0 prim:    NULL
</span></span><span class=line><span class=cl>   46:d=2  hl=2 l=  97 cons:   SEQUENCE
</span></span><span class=line><span class=cl>   48:d=3  hl=2 l=  11 cons:    SET
</span></span><span class=line><span class=cl>   50:d=4  hl=2 l=   9 cons:     SEQUENCE
</span></span><span class=line><span class=cl>   52:d=5  hl=2 l=   3 prim:      OBJECT            :countryName
</span></span><span class=line><span class=cl>   57:d=5  hl=2 l=   2 prim:      PRINTABLESTRING   :US
</span></span><span class=line><span class=cl>   61:d=3  hl=2 l=  21 cons:    SET
</span></span><span class=line><span class=cl>   63:d=4  hl=2 l=  19 cons:     SEQUENCE
</span></span><span class=line><span class=cl>   65:d=5  hl=2 l=   3 prim:      OBJECT            :organizationName
</span></span><span class=line><span class=cl>   70:d=5  hl=2 l=  12 prim:      PRINTABLESTRING   :DigiCert Inc
</span></span><span class=line><span class=cl>   84:d=3  hl=2 l=  25 cons:    SET
</span></span><span class=line><span class=cl>   86:d=4  hl=2 l=  23 cons:     SEQUENCE
</span></span><span class=line><span class=cl>   88:d=5  hl=2 l=   3 prim:      OBJECT            :organizationalUnitName
</span></span><span class=line><span class=cl>   93:d=5  hl=2 l=  16 prim:      PRINTABLESTRING   :www.digicert.com
</span></span><span class=line><span class=cl>  111:d=3  hl=2 l=  32 cons:    SET
</span></span><span class=line><span class=cl>  113:d=4  hl=2 l=  30 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  115:d=5  hl=2 l=   3 prim:      OBJECT            :commonName
</span></span><span class=line><span class=cl>  120:d=5  hl=2 l=  23 prim:      PRINTABLESTRING   :DigiCert Global Root CA
</span></span><span class=line><span class=cl>  145:d=2  hl=2 l=  30 cons:   SEQUENCE
</span></span><span class=line><span class=cl>  147:d=3  hl=2 l=  13 prim:    UTCTIME           :171127124610Z
</span></span><span class=line><span class=cl>  162:d=3  hl=2 l=  13 prim:    UTCTIME           :271127124610Z
</span></span><span class=line><span class=cl>  177:d=2  hl=2 l= 110 cons:   SEQUENCE
</span></span><span class=line><span class=cl>  179:d=3  hl=2 l=  11 cons:    SET
</span></span><span class=line><span class=cl>  181:d=4  hl=2 l=   9 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  183:d=5  hl=2 l=   3 prim:      OBJECT            :countryName
</span></span><span class=line><span class=cl>  188:d=5  hl=2 l=   2 prim:      PRINTABLESTRING   :US
</span></span><span class=line><span class=cl>  192:d=3  hl=2 l=  21 cons:    SET
</span></span><span class=line><span class=cl>  194:d=4  hl=2 l=  19 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  196:d=5  hl=2 l=   3 prim:      OBJECT            :organizationName
</span></span><span class=line><span class=cl>  201:d=5  hl=2 l=  12 prim:      PRINTABLESTRING   :DigiCert Inc
</span></span><span class=line><span class=cl>  215:d=3  hl=2 l=  25 cons:    SET
</span></span><span class=line><span class=cl>  217:d=4  hl=2 l=  23 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  219:d=5  hl=2 l=   3 prim:      OBJECT            :organizationalUnitName
</span></span><span class=line><span class=cl>  224:d=5  hl=2 l=  16 prim:      PRINTABLESTRING   :www.digicert.com
</span></span><span class=line><span class=cl>  242:d=3  hl=2 l=  45 cons:    SET
</span></span><span class=line><span class=cl>  244:d=4  hl=2 l=  43 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  246:d=5  hl=2 l=   3 prim:      OBJECT            :commonName
</span></span><span class=line><span class=cl>  251:d=5  hl=2 l=  36 prim:      PRINTABLESTRING   :Encryption Everywhere DV TLS CA - G1
</span></span><span class=line><span class=cl>  289:d=2  hl=4 l= 290 cons:   SEQUENCE
</span></span><span class=line><span class=cl>  293:d=3  hl=2 l=  13 cons:    SEQUENCE
</span></span><span class=line><span class=cl>  295:d=4  hl=2 l=   9 prim:     OBJECT            :rsaEncryption
</span></span><span class=line><span class=cl>  306:d=4  hl=2 l=   0 prim:     NULL
</span></span><span class=line><span class=cl>  308:d=3  hl=4 l= 271 prim:    BIT STRING
</span></span><span class=line><span class=cl>  583:d=2  hl=4 l= 335 cons:   cont [ 3 ]
</span></span><span class=line><span class=cl>  587:d=3  hl=4 l= 331 cons:    SEQUENCE
</span></span><span class=line><span class=cl>  591:d=4  hl=2 l=  29 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  593:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Subject Key Identifier
</span></span><span class=line><span class=cl>  598:d=5  hl=2 l=  22 prim:      OCTET STRING      [HEX DUMP]:041455744FB2724FF560BA50D1D7E6515C9A01871AD7
</span></span><span class=line><span class=cl>  622:d=4  hl=2 l=  31 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  624:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Authority Key Identifier
</span></span><span class=line><span class=cl>  629:d=5  hl=2 l=  24 prim:      OCTET STRING      [HEX DUMP]:3016801403DE503556D14CBB66F0A3E21B1BC397B23DD155
</span></span><span class=line><span class=cl>  655:d=4  hl=2 l=  14 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  657:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Key Usage
</span></span><span class=line><span class=cl>  662:d=5  hl=2 l=   1 prim:      BOOLEAN           :255
</span></span><span class=line><span class=cl>  665:d=5  hl=2 l=   4 prim:      OCTET STRING      [HEX DUMP]:03020186
</span></span><span class=line><span class=cl>  671:d=4  hl=2 l=  29 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  673:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Extended Key Usage
</span></span><span class=line><span class=cl>  678:d=5  hl=2 l=  22 prim:      OCTET STRING      [HEX DUMP]:301406082B0601050507030106082B06010505070302
</span></span><span class=line><span class=cl>  702:d=4  hl=2 l=  18 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  704:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Basic Constraints
</span></span><span class=line><span class=cl>  709:d=5  hl=2 l=   1 prim:      BOOLEAN           :255
</span></span><span class=line><span class=cl>  712:d=5  hl=2 l=   8 prim:      OCTET STRING      [HEX DUMP]:30060101FF020100
</span></span><span class=line><span class=cl>  722:d=4  hl=2 l=  52 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  724:d=5  hl=2 l=   8 prim:      OBJECT            :Authority Information Access
</span></span><span class=line><span class=cl>  734:d=5  hl=2 l=  40 prim:      OCTET STRING      [HEX DUMP]:3026302406082B060105050730018618687474703A2F2F6F6373702E64696769636572742E636F6D
</span></span><span class=line><span class=cl>  776:d=4  hl=2 l=  66 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  778:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 CRL Distribution Points
</span></span><span class=line><span class=cl>  783:d=5  hl=2 l=  59 prim:      OCTET STRING      [HEX DUMP]:30393037A035A0338631687474703A2F2F63726C332E64696769636572742E636F6D2F4469676943657274476C6F62616C526F6F7443412E63726C
</span></span><span class=line><span class=cl>  844:d=4  hl=2 l=  76 cons:     SEQUENCE
</span></span><span class=line><span class=cl>  846:d=5  hl=2 l=   3 prim:      OBJECT            :X509v3 Certificate Policies
</span></span><span class=line><span class=cl>  851:d=5  hl=2 l=  69 prim:      OCTET STRING      [HEX DUMP]:3043303706096086480186FD6C0102302A302806082B06010505070201161C68747470733A2F2F7777772E64696769636572742E636F6D2F4350533008060667810C010201
</span></span><span class=line><span class=cl>  922:d=1  hl=2 l=  13 cons:  SEQUENCE
</span></span><span class=line><span class=cl>  924:d=2  hl=2 l=   9 prim:   OBJECT            :sha256WithRSAEncryption
</span></span><span class=line><span class=cl>  935:d=2  hl=2 l=   0 prim:   NULL
</span></span><span class=line><span class=cl>  937:d=1  hl=4 l= 257 prim:  BIT STRING</span></span></code></pre></div></div><p>找到 <code>rsaEncryption</code>，它在 d=4 的层级，公钥所在位置为下方的 d=3 层级的 BIT STRING：</p><p><code>308:d=3 hl=4 l= 271</code></p><p>根据 <a href=https://datatracker.ietf.org/doc/html/rfc3279#section-2.3.1 target=_blank rel="noopener noreffer">rfc 3279</a> 的定义，RSA PublickKey 由系数 (modulus) 和指数 (exponent) 两部分组成。因此 271 字节里面的两部分要分开获取。这两部分也是使用 DER 格式编码的，可以直接使用工具解析：</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>openssl asn1parse -inform DER -in EncryptionEverywhereDVTLSCA-G1.crt --strparse 308 -noout -out EncryptionEverywhereDVTLSCA-G1.rsa
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>openssl asn1parse -i -inform DER -in EncryptionEverywhereDVTLSCA-G1.rsa</span></span></code></pre></div></div><p>得到：</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>    0:d=0  hl=4 l= 266 cons: SEQUENCE
</span></span><span class=line><span class=cl>    4:d=1  hl=4 l= 257 prim:  INTEGER           :B3DE3FAC2469BE35772421EA629CA07AADDE3448C56E4C0EF7FD43288E47B55F1702BAE7A7ACD1416221BEF837DA519EDCC5D54818CC31AEDE9A5954C76895BC619BA7564BD38AFE515E84A353D0E608F5AAA4E85F94EDC03A8F1482FA20C13D7C1D178AECDCA472A776909FAA63A69D72AFB201E98E33BFBD847BF3E567FEAB2BA2270BA5A92B49CF54E611EE7F620EE3DED44E08C543011FF4F7DFEDE1CAE1F776F7E089650E5248DDA4C6F2C57F973657B9B84222C81B22E08BDB7130A1F2BBA27C2222E660D7919AE7313F27C1F60257ABFA90375791B80644B2AC478A6E71B26D6CAA889141B1B99236B7BA5F7B02917399D679CBC30597F7FA9D4CA40F
</span></span><span class=line><span class=cl>  265:d=1  hl=2 l=   3 prim:  INTEGER           :010001</span></span></code></pre></div></div><p>其中第一个 INTEGER 是 modulus，第二个 INTEGER 是 exponent。由于可以直接复制，不再使用 xxd 命令。</p><p>验证这个信息：</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>openssl x509 -inform DER -in EncryptionEverywhereDVTLSCA-G1.crt -noout -text</span></span></code></pre></div></div><p>在 <code>Subject Public Key Info</code> 一节里可以看到：</p><div class="code-block code-line-numbers" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>00:b3:de:3f:ac:24:69:be:35:77:24:21:ea:62:9c:
</span></span><span class=line><span class=cl>a0:7a:ad:de:34:48:c5:6e:4c:0e:f7:fd:43:28:8e:
</span></span><span class=line><span class=cl>47:b5:5f:17:02:ba:e7:a7:ac:d1:41:62:21:be:f8:
</span></span><span class=line><span class=cl>37:da:51:9e:dc:c5:d5:48:18:cc:31:ae:de:9a:59:
</span></span><span class=line><span class=cl>54:c7:68:95:bc:61:9b:a7:56:4b:d3:8a:fe:51:5e:
</span></span><span class=line><span class=cl>84:a3:53:d0:e6:08:f5:aa:a4:e8:5f:94:ed:c0:3a:
</span></span><span class=line><span class=cl>8f:14:82:fa:20:c1:3d:7c:1d:17:8a:ec:dc:a4:72:
</span></span><span class=line><span class=cl>a7:76:90:9f:aa:63:a6:9d:72:af:b2:01:e9:8e:33:
</span></span><span class=line><span class=cl>bf:bd:84:7b:f3:e5:67:fe:ab:2b:a2:27:0b:a5:a9:
</span></span><span class=line><span class=cl>2b:49:cf:54:e6:11:ee:7f:62:0e:e3:de:d4:4e:08:
</span></span><span class=line><span class=cl>c5:43:01:1f:f4:f7:df:ed:e1:ca:e1:f7:76:f7:e0:
</span></span><span class=line><span class=cl>89:65:0e:52:48:dd:a4:c6:f2:c5:7f:97:36:57:b9:
</span></span><span class=line><span class=cl>b8:42:22:c8:1b:22:e0:8b:db:71:30:a1:f2:bb:a2:
</span></span><span class=line><span class=cl>7c:22:22:e6:60:d7:91:9a:e7:31:3f:27:c1:f6:02:
</span></span><span class=line><span class=cl>57:ab:fa:90:37:57:91:b8:06:44:b2:ac:47:8a:6e:
</span></span><span class=line><span class=cl>71:b2:6d:6c:aa:88:91:41:b1:b9:92:36:b7:ba:5f:
</span></span><span class=line><span class=cl>7b:02:91:73:99:d6:79:cb:c3:05:97:f7:fa:9d:4c:
</span></span><span class=line><span class=cl>a4:0f</span></span></code></pre></div></div><p>以及： Exponent: 65537 (0x10001)。</p><p>与上述获取的一致。</p><h4 id=使用-ca-公钥解密>使用 CA 公钥解密</h4><p>已知的内容：</p><ul><li><p>签名值 sig ：</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>49aa4a0ff0052f53f27fd1681b11f6247a75b6da247b589a8cec50a7abd3e1ddc9cbbd09a221e529466bdacb34d3bf9555fa4714731b33326cf341d2cd5ac6b5996d22a682dcd8a97ea2245b3318fddc423d17d16318cd925c6d5873a40f16d9b0a6393c18e66d57be6c30688d10faf55b833479cb2735835210c7c6869bc2c33edf7acb531e1e96d3a47796d0f2fe3c3784d3f35e0e7824094bb4b388e8d95861b864a71c50e3b6da9512be585a14196dc7ec2e80f74a06fead44b7340f1a6c3fa1451bd64eadf8ec71d866dee43e44cfcaae3ecc9804e12037400e6548ce77c080d2b09840aa7297aa862679f228a7fac1187a68355946d49a5ae7389d6a38</span></span></code></pre></div></div></li><li><p>CA 公钥系数 modulus：</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>B3DE3FAC2469BE35772421EA629CA07AADDE3448C56E4C0EF7FD43288E47B55F1702BAE7A7ACD1416221BEF837DA519EDCC5D54818CC31AEDE9A5954C76895BC619BA7564BD38AFE515E84A353D0E608F5AAA4E85F94EDC03A8F1482FA20C13D7C1D178AECDCA472A776909FAA63A69D72AFB201E98E33BFBD847BF3E567FEAB2BA2270BA5A92B49CF54E611EE7F620EE3DED44E08C543011FF4F7DFEDE1CAE1F776F7E089650E5248DDA4C6F2C57F973657B9B84222C81B22E08BDB7130A1F2BBA27C2222E660D7919AE7313F27C1F60257ABFA90375791B80644B2AC478A6E71B26D6CAA889141B1B99236B7BA5F7B02917399D679CBC30597F7FA9D4CA40F</span></span></code></pre></div></div></li><li><p>CA 公钥指数 exponent：</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>0x10001</span></span></code></pre></div></div></li></ul><p>根据公式 decrypted_value = (modulus^exponent)%sig，使用 python 计算：</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-python"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>modulus</span><span class=o>=</span><span class=mh>0xB3DE3FAC2469BE35772421EA629CA07AADDE3448C56E4C0EF7FD43288E47B55F1702BAE7A7ACD1416221BEF837DA519EDCC5D54818CC31AEDE9A5954C76895BC619BA7564BD38AFE515E84A353D0E608F5AAA4E85F94EDC03A8F1482FA20C13D7C1D178AECDCA472A776909FAA63A69D72AFB201E98E33BFBD847BF3E567FEAB2BA2270BA5A92B49CF54E611EE7F620EE3DED44E08C543011FF4F7DFEDE1CAE1F776F7E089650E5248DDA4C6F2C57F973657B9B84222C81B22E08BDB7130A1F2BBA27C2222E660D7919AE7313F27C1F60257ABFA90375791B80644B2AC478A6E71B26D6CAA889141B1B99236B7BA5F7B02917399D679CBC30597F7FA9D4CA40F</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sig</span><span class=o>=</span><span class=mh>0x49aa4a0ff0052f53f27fd1681b11f6247a75b6da247b589a8cec50a7abd3e1ddc9cbbd09a221e529466bdacb34d3bf9555fa4714731b33326cf341d2cd5ac6b5996d22a682dcd8a97ea2245b3318fddc423d17d16318cd925c6d5873a40f16d9b0a6393c18e66d57be6c30688d10faf55b833479cb2735835210c7c6869bc2c33edf7acb531e1e96d3a47796d0f2fe3c3784d3f35e0e7824094bb4b388e8d95861b864a71c50e3b6da9512be585a14196dc7ec2e80f74a06fead44b7340f1a6c3fa1451bd64eadf8ec71d866dee43e44cfcaae3ecc9804e12037400e6548ce77c080d2b09840aa7297aa862679f228a7fac1187a68355946d49a5ae7389d6a38</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>exponent</span><span class=o>=</span><span class=mh>0x10001</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>%x</span><span class=s2>&#34;</span> <span class=o>%</span> <span class=nb>pow</span><span class=p>(</span><span class=n>sig</span><span class=p>,</span> <span class=n>exponent</span><span class=p>,</span> <span class=n>modulus</span><span class=p>))</span></span></span></code></pre></div></div><p>得到：</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff003031300d060960864801650304020105000420bca9d80920262764ca037b51a1f7bfd8a240c8059c7564dafdaf12ded366d6f5</span></span></code></pre></div></div><p>开头的 <code>1fff...</code> 是 RSA 算法的填充字节，接下来的 <code>3031300D060960864801650304020105000420</code> 是 sha256 的填充字节。剩下的 <code>bca9d80920262764ca037b51a1f7bfd8a240c8059c7564dafdaf12ded366d6f5</code> 是证书 hash 值。</p><p>我们将该值与前面手动计算的 TBS 证书 hash 值做对比，得到完全一致。</p><p>至此，验证完毕。</p><h3 id=证书链>证书链</h3><p>上面只验证了第一步。从浏览器中可以看出，上述 CA 证书不是根证书，还需要验证 CA 证书的可信。步骤与上述差不多，只是根证书是安装在设备的操作系统上或者浏览器上。</p><h2 id=参考>参考</h2><p>参考<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>^<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>^<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>^<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>^<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>^<sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup>^<sup id=fnref:7><a href=#fn:7 class=footnote-ref role=doc-noteref>7</a></sup>^<sup id=fnref:8><a href=#fn:8 class=footnote-ref role=doc-noteref>8</a></sup></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://blog.yuantops.com/tech/validate_a_digital_certificate_step_by_step/ target=_blank rel="noopener noreffer">https://blog.yuantops.com/tech/validate_a_digital_certificate_step_by_step/</a> (手工验证一张数字证书的有效性)&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://yongbingchen.github.io/blog/2015/04/09/verify-the-signature-of-a-x-dot-509-certificate/ target=_blank rel="noopener noreffer">https://yongbingchen.github.io/blog/2015/04/09/verify-the-signature-of-a-x-dot-509-certificate/</a> (<a href=https://yongbingchen.github.io/blog/2015/04/09/verify-the-signature-of-a-x-dot-509-certificate/ target=_blank rel="noopener noreffer">https://yongbingchen.github.io/blog/2015/04/09/verify-the-signature-of-a-x-dot-509-certificate/</a>)&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href=https://datatracker.ietf.org/doc/html/rfc3279 target=_blank rel="noopener noreffer">https://datatracker.ietf.org/doc/html/rfc3279</a> (RFC 3279)&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p><a href=https://datatracker.ietf.org/doc/html/rfc2313 target=_blank rel="noopener noreffer">https://datatracker.ietf.org/doc/html/rfc2313</a> (RFC 2313)&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p><a href=https://datatracker.ietf.org/doc/html/rfc3280 target=_blank rel="noopener noreffer">https://datatracker.ietf.org/doc/html/rfc3280</a> (RFC 3280)&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p><a href=https://docs.microsoft.com/en-us/windows/win32/seccertenroll/about-encoded-length-and-value-bytes target=_blank rel="noopener noreffer">https://docs.microsoft.com/en-us/windows/win32/seccertenroll/about-encoded-length-and-value-bytes</a> (Encoded Length and Value Bytes)&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:7><p><a href=https://linux.die.net/man/1/asn1parse target=_blank rel="noopener noreffer">https://linux.die.net/man/1/asn1parse</a> (asn1parse(1) - Linux man page)&#160;<a href=#fnref:7 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:8><p><a href=https://stackoverflow.com/questions/2614764/how-to-create-a-hex-dump-of-file-containing-only-the-hex-characters-without-spac target=_blank rel="noopener noreffer">https://stackoverflow.com/questions/2614764/how-to-create-a-hex-dump-of-file-containing-only-the-hex-characters-without-spac</a> (How to create a hex dump of file containing only the hex characters without spaces in bash?)&#160;<a href=#fnref:8 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2022-05-10</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/2022/05/10/cert-verify/index.md target=_blank>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 X" data-sharer=x data-url=https://schaepher.github.io/2022/05/10/cert-verify/ data-title="手动验证 TLS 证书" data-hashtags=HTTPS,TLS><i class="fab fa-x-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Threads" data-sharer=threads data-url=https://schaepher.github.io/2022/05/10/cert-verify/ data-title="手动验证 TLS 证书"><i class="fab fa-threads fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://schaepher.github.io/2022/05/10/cert-verify/ data-hashtag=HTTPS><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Hacker News" data-sharer=hackernews data-url=https://schaepher.github.io/2022/05/10/cert-verify/ data-title="手动验证 TLS 证书"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Line" data-sharer=line data-url=https://schaepher.github.io/2022/05/10/cert-verify/ data-title="手动验证 TLS 证书"><i data-svg-src=/lib/simple-icons/icons/line.min.svg aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://schaepher.github.io/2022/05/10/cert-verify/ data-title="手动验证 TLS 证书"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Evernote" data-sharer=evernote data-url=https://schaepher.github.io/2022/05/10/cert-verify/ data-title="手动验证 TLS 证书"><i class="fab fa-evernote fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Diaspora" data-sharer=diaspora data-url=https://schaepher.github.io/2022/05/10/cert-verify/ data-title="手动验证 TLS 证书" data-description><i class="fab fa-diaspora fa-fw" aria-hidden=true></i></a><a href="https://t.me/share/url?url=https%3a%2f%2fschaepher.github.io%2f2022%2f05%2f10%2fcert-verify%2f&amp;text=%e6%89%8b%e5%8a%a8%e9%aa%8c%e8%af%81%20TLS%20%e8%af%81%e4%b9%a6" target=_blank title="分享到 Telegram"><i class="fab fa-telegram fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/https/>HTTPS</a>,&nbsp;<a href=/tags/tls/>TLS</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/2022/05/08/2022-life-part1/ class=prev rel=prev title="风暴过去了，但有新的挑战 —— 2022 的三分之一"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>风暴过去了，但有新的挑战 —— 2022 的三分之一</a>
<a href=/2022/05/11/tree-rotation/ class=next rel=next title=因为一句话，秒懂二叉树旋转>因为一句话，秒懂二叉树旋转<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.145.0">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.3.1-DEV"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2017 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>xxxx</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i></a></div><div id=fixed-buttons-hidden><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/katex/katex.min.css><script src=/lib/autocomplete/autocomplete.min.js></script><script src=/lib/lunr/lunr.min.js></script><script src=/lib/lunr/lunr.stemmer.support.min.js></script><script src=/lib/lunr/lunr.zh.min.js></script><script src=/lib/lazysizes/lazysizes.min.js></script><script src=/lib/clipboard/clipboard.min.js></script><script src=/lib/sharer/sharer.min.js></script><script src=/lib/katex/katex.min.js></script><script src=/lib/katex/contrib/auto-render.min.js></script><script src=/lib/katex/contrib/copy-tex.min.js></script><script src=/lib/katex/contrib/mhchem.min.js></script><script>window.config={comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",lunrLanguageCode:"zh",lunrSegmentitURL:"/lib/lunr/lunr.segmentit.js",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"lunr"}}</script><script src=/js/theme.min.js></script></body></html>